<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=JamFox><link href=https://docs.jamfox.dev/content/devops/vaultkrb/ rel=canonical><link href=../vaultad/ rel=prev><link href=../sops/ rel=next><link rel=icon href=../../../assets/icon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.12"><title>Hashicorp Vault integration with Kerberos/LDAP - JamFox's Documentation</title><link rel=stylesheet href=../../../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Noto Sans";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script defer src=https://cloud.umami.is/script.js data-website-id=bead9d93-4ef7-4e94-b53b-c936abe55767></script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#what-is-vault class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="JamFox's Documentation" class="md-header__button md-logo" aria-label="JamFox's Documentation" data-md-component=logo> <img src=../../../assets/icon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> JamFox's Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Hashicorp Vault integration with Kerberos/LDAP </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/JamFox/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> github.com/JamFox </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../homelab/ class=md-tabs__link> HomeLab </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> DevOps </a> </li> <li class=md-tabs__item> <a href=../../food/ class=md-tabs__link> Food & Drinks </a> </li> <li class=md-tabs__item> <a href=../../links/ class=md-tabs__link> Links </a> </li> <li class=md-tabs__item> <a href=../../extras/ class=md-tabs__link> Other </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="JamFox's Documentation" class="md-nav__button md-logo" aria-label="JamFox's Documentation" data-md-component=logo> <img src=../../../assets/icon.png alt=logo> </a> JamFox's Documentation </label> <div class=md-nav__source> <a href=https://github.com/JamFox/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> github.com/JamFox </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../homelab/ class=md-nav__link> <span class=md-ellipsis> HomeLab </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> DevOps </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> DevOps </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Version Control </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Version Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../semver/ class=md-nav__link> <span class=md-ellipsis> Semantic Versioning </span> </a> </li> <li class=md-nav__item> <a href=../gitbasics/ class=md-nav__link> <span class=md-ellipsis> Git For Beginners </span> </a> </li> <li class=md-nav__item> <a href=../gitdos/ class=md-nav__link> <span class=md-ellipsis> Git DOs & DON'Ts </span> </a> </li> <li class=md-nav__item> <a href=../precommit/ class=md-nav__link> <span class=md-ellipsis> Precommit </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Performance Testing & Benchmarking </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Performance Testing & Benchmarking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../performance-testing-benchmarking/ class=md-nav__link> <span class=md-ellipsis> Performance Testing & Benchmarking </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex> <span class=md-ellipsis> Configuration Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Configuration Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../saltstack-for-ansible/ class=md-nav__link> <span class=md-ellipsis> Ansible User's Guide to Saltstack </span> </a> </li> <li class=md-nav__item> <a href=../ansiblevault/ class=md-nav__link> <span class=md-ellipsis> Ansible Vault </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex> <span class=md-ellipsis> Provisioning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Provisioning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../packer/ class=md-nav__link> <span class=md-ellipsis> Hashicorp Packer </span> </a> </li> <li class=md-nav__item> <a href=../terraform/ class=md-nav__link> <span class=md-ellipsis> Hashicorp Terraform </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex> <span class=md-ellipsis> GitLab </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> GitLab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../packerci/ class=md-nav__link> <span class=md-ellipsis> OpenStack Packer GitLab CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../gitlabrunnershare/ class=md-nav__link> <span class=md-ellipsis> Sharing Runners To Multiple Projects </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex> <span class=md-ellipsis> Orchestration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Orchestration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../orchestrationexplained/ class=md-nav__link> <span class=md-ellipsis> Orchestration Fundamentals Explained Simply </span> </a> </li> <li class=md-nav__item> <a href=../consul/ class=md-nav__link> <span class=md-ellipsis> Hashicorp Consul </span> </a> </li> <li class=md-nav__item> <a href=../nomad/ class=md-nav__link> <span class=md-ellipsis> Hashicorp Nomad </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes/ class=md-nav__link> <span class=md-ellipsis> Kubernetes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_8 checked> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex> <span class=md-ellipsis> Secrets Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=true> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Secrets Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../vaultad/ class=md-nav__link> <span class=md-ellipsis> Vault with AD </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Vault with Kerberos </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Vault with Kerberos </span> </a> <nav class="md-nav md-nav--secondary" aria-label="On this page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-vault class=md-nav__link> <span class=md-ellipsis> What is Vault? </span> </a> </li> <li class=md-nav__item> <a href=#why-vault-is-especially-significant-in-tandem-with-kerberos class=md-nav__link> <span class=md-ellipsis> Why Vault is especially significant in tandem with Kerberos </span> </a> </li> <li class=md-nav__item> <a href=#how-do-i-access-vault class=md-nav__link> <span class=md-ellipsis> How do I access Vault? </span> </a> </li> <li class=md-nav__item> <a href=#admin-guide class=md-nav__link> <span class=md-ellipsis> ADMIN GUIDE </span> </a> <nav class=md-nav aria-label="ADMIN GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#necessary-first-step class=md-nav__link> <span class=md-ellipsis> Necessary first step </span> </a> </li> <li class=md-nav__item> <a href=#ldap-config-user-auth class=md-nav__link> <span class=md-ellipsis> LDAP config (user auth) </span> </a> </li> <li class=md-nav__item> <a href=#kerberos-config-host-auth class=md-nav__link> <span class=md-ellipsis> Kerberos config (host auth) </span> </a> </li> <li class=md-nav__item> <a href=#creating-policies class=md-nav__link> <span class=md-ellipsis> Creating policies </span> </a> <nav class=md-nav aria-label="Creating policies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#syntax-and-usage class=md-nav__link> <span class=md-ellipsis> Syntax and usage </span> </a> </li> <li class=md-nav__item> <a href=#path-capabilities-cheat-sheet class=md-nav__link> <span class=md-ellipsis> Path capabilities cheat sheet </span> </a> </li> <li class=md-nav__item> <a href=#templating-policies class=md-nav__link> <span class=md-ellipsis> Templating policies </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client-guide class=md-nav__link> <span class=md-ellipsis> CLIENT GUIDE </span> </a> <nav class=md-nav aria-label="CLIENT GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#necessary-first-step-client class=md-nav__link> <span class=md-ellipsis> Necessary first step (client) </span> </a> <nav class=md-nav aria-label="Necessary first step (client)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-auth class=md-nav__link> <span class=md-ellipsis> User auth </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#host-auth class=md-nav__link> <span class=md-ellipsis> Host auth </span> </a> </li> <li class=md-nav__item> <a href=#using-vault class=md-nav__link> <span class=md-ellipsis> Using Vault </span> </a> <nav class=md-nav aria-label="Using Vault"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#key-value-secrets class=md-nav__link> <span class=md-ellipsis> Key-Value Secrets </span> </a> </li> <li class=md-nav__item> <a href=#secret-sharing-using-keyvalue-v1 class=md-nav__link> <span class=md-ellipsis> Secret sharing using key/value V1 </span> </a> <nav class=md-nav aria-label="Secret sharing using key/value V1"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#short-of-it-cheat-sheet class=md-nav__link> <span class=md-ellipsis> Short of it - cheat sheet </span> </a> </li> <li class=md-nav__item> <a href=#long-of-it-a-practical-demo class=md-nav__link> <span class=md-ellipsis> Long of it - a practical demo </span> </a> <nav class=md-nav aria-label="Long of it - a practical demo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scenario-1-one-way-secret-sharing-with-another-user class=md-nav__link> <span class=md-ellipsis> Scenario 1 - one way secret sharing with another user </span> </a> </li> <li class=md-nav__item> <a href=#scenario-2-general-secret-sharing class=md-nav__link> <span class=md-ellipsis> Scenario 2 - general secret sharing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transit-secrets class=md-nav__link> <span class=md-ellipsis> Transit secrets </span> </a> <nav class=md-nav aria-label="Transit secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example class=md-nav__link> <span class=md-ellipsis> Usage example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transform-secrets-requires-vault-enterprise class=md-nav__link> <span class=md-ellipsis> Transform secrets (requires Vault Enterprise) </span> </a> <nav class=md-nav aria-label="Transform secrets (requires Vault Enterprise)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example-transform class=md-nav__link> <span class=md-ellipsis> Usage example (transform) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#active-directory-secrets class=md-nav__link> <span class=md-ellipsis> Active Directory secrets </span> </a> </li> <li class=md-nav__item> <a href=#openldap-secrets class=md-nav__link> <span class=md-ellipsis> OpenLDAP secrets </span> </a> </li> <li class=md-nav__item> <a href=#pki-secrets class=md-nav__link> <span class=md-ellipsis> PKI secrets </span> </a> <nav class=md-nav aria-label="PKI secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example-pki class=md-nav__link> <span class=md-ellipsis> Usage example (pki) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-secrets class=md-nav__link> <span class=md-ellipsis> Database secrets </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#usage-quick-guide class=md-nav__link> <span class=md-ellipsis> USAGE QUICK GUIDE </span> </a> <nav class=md-nav aria-label="USAGE QUICK GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cli class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> <nav class=md-nav aria-label=CLI> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-user-usage class=md-nav__link> <span class=md-ellipsis> CERN AD user usage </span> </a> </li> <li class=md-nav__item> <a href=#personal-secrets class=md-nav__link> <span class=md-ellipsis> Personal secrets </span> </a> </li> <li class=md-nav__item> <a href=#inbox-secrets class=md-nav__link> <span class=md-ellipsis> Inbox secrets </span> </a> </li> <li class=md-nav__item> <a href=#general-secrets class=md-nav__link> <span class=md-ellipsis> General secrets </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#host class=md-nav__link> <span class=md-ellipsis> Host </span> </a> <nav class=md-nav aria-label=Host> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-host-usage class=md-nav__link> <span class=md-ellipsis> CERN AD host usage </span> </a> </li> <li class=md-nav__item> <a href=#manual-host-usage class=md-nav__link> <span class=md-ellipsis> Manual host usage </span> </a> </li> <li class=md-nav__item> <a href=#ansible-host-usage class=md-nav__link> <span class=md-ellipsis> Ansible host usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#web-ui class=md-nav__link> <span class=md-ellipsis> Web UI </span> </a> <nav class=md-nav aria-label="Web UI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-user-usage_1 class=md-nav__link> <span class=md-ellipsis> CERN AD user usage </span> </a> </li> <li class=md-nav__item> <a href=#personal-secrets_1 class=md-nav__link> <span class=md-ellipsis> Personal secrets </span> </a> </li> <li class=md-nav__item> <a href=#inbox-secrets_1 class=md-nav__link> <span class=md-ellipsis> Inbox secrets </span> </a> </li> <li class=md-nav__item> <a href=#general-secrets_1 class=md-nav__link> <span class=md-ellipsis> General secrets </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sops/ class=md-nav__link> <span class=md-ellipsis> Mozilla SOPS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../networking/ class=md-nav__link> <span class=md-ellipsis> Networking </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10 id=__nav_3_10_label tabindex> <span class=md-ellipsis> Storage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_10_label aria-expanded=false> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Storage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ceph/ class=md-nav__link> <span class=md-ellipsis> Ceph </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11> <label class=md-nav__link for=__nav_3_11 id=__nav_3_11_label tabindex> <span class=md-ellipsis> AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_11_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ai-build/ class=md-nav__link> <span class=md-ellipsis> Building AI </span> </a> </li> <li class=md-nav__item> <a href=../prompteng/ class=md-nav__link> <span class=md-ellipsis> Prompt Engineering </span> </a> </li> <li class=md-nav__item> <a href=../stablediffusion/ class=md-nav__link> <span class=md-ellipsis> Stable Diffusion </span> </a> </li> <li class=md-nav__item> <a href=../stablediffusion-ps1/ class=md-nav__link> <span class=md-ellipsis> Playstation Filter Using Stable Diffusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_12> <label class=md-nav__link for=__nav_3_12 id=__nav_3_12_label tabindex> <span class=md-ellipsis> Red Teaming & Penetration Testing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_12_label aria-expanded=false> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Red Teaming & Penetration Testing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../redteaming/ class=md-nav__link> <span class=md-ellipsis> Red Teaming </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../food/ class=md-nav__link> <span class=md-ellipsis> Food & Drinks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../links/ class=md-nav__link> <span class=md-ellipsis> Links </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../extras/ class=md-nav__link> <span class=md-ellipsis> Other </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="On this page"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> On this page </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-vault class=md-nav__link> <span class=md-ellipsis> What is Vault? </span> </a> </li> <li class=md-nav__item> <a href=#why-vault-is-especially-significant-in-tandem-with-kerberos class=md-nav__link> <span class=md-ellipsis> Why Vault is especially significant in tandem with Kerberos </span> </a> </li> <li class=md-nav__item> <a href=#how-do-i-access-vault class=md-nav__link> <span class=md-ellipsis> How do I access Vault? </span> </a> </li> <li class=md-nav__item> <a href=#admin-guide class=md-nav__link> <span class=md-ellipsis> ADMIN GUIDE </span> </a> <nav class=md-nav aria-label="ADMIN GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#necessary-first-step class=md-nav__link> <span class=md-ellipsis> Necessary first step </span> </a> </li> <li class=md-nav__item> <a href=#ldap-config-user-auth class=md-nav__link> <span class=md-ellipsis> LDAP config (user auth) </span> </a> </li> <li class=md-nav__item> <a href=#kerberos-config-host-auth class=md-nav__link> <span class=md-ellipsis> Kerberos config (host auth) </span> </a> </li> <li class=md-nav__item> <a href=#creating-policies class=md-nav__link> <span class=md-ellipsis> Creating policies </span> </a> <nav class=md-nav aria-label="Creating policies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#syntax-and-usage class=md-nav__link> <span class=md-ellipsis> Syntax and usage </span> </a> </li> <li class=md-nav__item> <a href=#path-capabilities-cheat-sheet class=md-nav__link> <span class=md-ellipsis> Path capabilities cheat sheet </span> </a> </li> <li class=md-nav__item> <a href=#templating-policies class=md-nav__link> <span class=md-ellipsis> Templating policies </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client-guide class=md-nav__link> <span class=md-ellipsis> CLIENT GUIDE </span> </a> <nav class=md-nav aria-label="CLIENT GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#necessary-first-step-client class=md-nav__link> <span class=md-ellipsis> Necessary first step (client) </span> </a> <nav class=md-nav aria-label="Necessary first step (client)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-auth class=md-nav__link> <span class=md-ellipsis> User auth </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#host-auth class=md-nav__link> <span class=md-ellipsis> Host auth </span> </a> </li> <li class=md-nav__item> <a href=#using-vault class=md-nav__link> <span class=md-ellipsis> Using Vault </span> </a> <nav class=md-nav aria-label="Using Vault"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#key-value-secrets class=md-nav__link> <span class=md-ellipsis> Key-Value Secrets </span> </a> </li> <li class=md-nav__item> <a href=#secret-sharing-using-keyvalue-v1 class=md-nav__link> <span class=md-ellipsis> Secret sharing using key/value V1 </span> </a> <nav class=md-nav aria-label="Secret sharing using key/value V1"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#short-of-it-cheat-sheet class=md-nav__link> <span class=md-ellipsis> Short of it - cheat sheet </span> </a> </li> <li class=md-nav__item> <a href=#long-of-it-a-practical-demo class=md-nav__link> <span class=md-ellipsis> Long of it - a practical demo </span> </a> <nav class=md-nav aria-label="Long of it - a practical demo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scenario-1-one-way-secret-sharing-with-another-user class=md-nav__link> <span class=md-ellipsis> Scenario 1 - one way secret sharing with another user </span> </a> </li> <li class=md-nav__item> <a href=#scenario-2-general-secret-sharing class=md-nav__link> <span class=md-ellipsis> Scenario 2 - general secret sharing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transit-secrets class=md-nav__link> <span class=md-ellipsis> Transit secrets </span> </a> <nav class=md-nav aria-label="Transit secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example class=md-nav__link> <span class=md-ellipsis> Usage example </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transform-secrets-requires-vault-enterprise class=md-nav__link> <span class=md-ellipsis> Transform secrets (requires Vault Enterprise) </span> </a> <nav class=md-nav aria-label="Transform secrets (requires Vault Enterprise)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example-transform class=md-nav__link> <span class=md-ellipsis> Usage example (transform) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#active-directory-secrets class=md-nav__link> <span class=md-ellipsis> Active Directory secrets </span> </a> </li> <li class=md-nav__item> <a href=#openldap-secrets class=md-nav__link> <span class=md-ellipsis> OpenLDAP secrets </span> </a> </li> <li class=md-nav__item> <a href=#pki-secrets class=md-nav__link> <span class=md-ellipsis> PKI secrets </span> </a> <nav class=md-nav aria-label="PKI secrets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage-example-pki class=md-nav__link> <span class=md-ellipsis> Usage example (pki) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#database-secrets class=md-nav__link> <span class=md-ellipsis> Database secrets </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#usage-quick-guide class=md-nav__link> <span class=md-ellipsis> USAGE QUICK GUIDE </span> </a> <nav class=md-nav aria-label="USAGE QUICK GUIDE"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cli class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> <nav class=md-nav aria-label=CLI> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-user-usage class=md-nav__link> <span class=md-ellipsis> CERN AD user usage </span> </a> </li> <li class=md-nav__item> <a href=#personal-secrets class=md-nav__link> <span class=md-ellipsis> Personal secrets </span> </a> </li> <li class=md-nav__item> <a href=#inbox-secrets class=md-nav__link> <span class=md-ellipsis> Inbox secrets </span> </a> </li> <li class=md-nav__item> <a href=#general-secrets class=md-nav__link> <span class=md-ellipsis> General secrets </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#host class=md-nav__link> <span class=md-ellipsis> Host </span> </a> <nav class=md-nav aria-label=Host> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-host-usage class=md-nav__link> <span class=md-ellipsis> CERN AD host usage </span> </a> </li> <li class=md-nav__item> <a href=#manual-host-usage class=md-nav__link> <span class=md-ellipsis> Manual host usage </span> </a> </li> <li class=md-nav__item> <a href=#ansible-host-usage class=md-nav__link> <span class=md-ellipsis> Ansible host usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#web-ui class=md-nav__link> <span class=md-ellipsis> Web UI </span> </a> <nav class=md-nav aria-label="Web UI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cern-ad-user-usage_1 class=md-nav__link> <span class=md-ellipsis> CERN AD user usage </span> </a> </li> <li class=md-nav__item> <a href=#personal-secrets_1 class=md-nav__link> <span class=md-ellipsis> Personal secrets </span> </a> </li> <li class=md-nav__item> <a href=#inbox-secrets_1 class=md-nav__link> <span class=md-ellipsis> Inbox secrets </span> </a> </li> <li class=md-nav__item> <a href=#general-secrets_1 class=md-nav__link> <span class=md-ellipsis> General secrets </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/JamFox/docs.jamfox.dev/raw/master/docs/content/devops/vaultkrb.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1>Vault with Kerberos</h1> <h2 id=what-is-vault>What is Vault?<a class=headerlink href=#what-is-vault title="Anchor link to this section for reference">ඞ</a></h2> <p>Vault is an identity-based secrets and encryption management system. A secret is anything that you want to tightly control access to, such as API encryption keys, passwords, or certificates. Vault provides encryption services that are gated by authentication and authorization methods. Using Vault's UI, CLI, or HTTP API, access to secrets and other sensitive data can be securely stored and managed, tightly controlled (restricted), and auditable.</p> <p>Examples of Vault use cases:</p> <ul> <li><a href=https://www.vaultproject.io/use-cases/automated-pki-infrastructure>Automated PKI Infrastructure</a></li> <li><a href=https://www.vaultproject.io/use-cases/data-encryption>Data Encryption &amp; Tokenization</a></li> <li><a href=https://www.vaultproject.io/use-cases/database-credential-rotation-with-vault>Database Credential Rotation</a></li> <li><a href=https://www.vaultproject.io/use-cases/dynamic-secrets>Dynamic Secrets</a></li> <li><a href=https://www.vaultproject.io/use-cases/identity-based-access>Identity-based Access</a></li> <li><a href=https://www.vaultproject.io/use-cases/key-management>Key Management</a></li> <li><a href=https://www.vaultproject.io/use-cases/kubernetes>Kubernetes Secrets</a></li> <li><a href=https://www.vaultproject.io/use-cases/secrets-management>Secrets Management</a></li> </ul> <h2 id=why-vault-is-especially-significant-in-tandem-with-kerberos>Why Vault is especially significant in tandem with Kerberos<a class=headerlink href=#why-vault-is-especially-significant-in-tandem-with-kerberos title="Anchor link to this section for reference">ඞ</a></h2> <p>CERN is a bit different in one crucial way: there is extra trust between the inventory (inventory management system, network DB, DNS) and the Kerberos authentication.</p> <p>If provisioning takes care of both building a machine and adding it to inventory, then provided that the provisioning process and inventory can be trusted you can add a link between inventory and Kerberos auth.</p> <p>Machines can (and already do!) ask for authentication with Kerberos automatically (on first boot for example), then Kerberos itself verifies machine credentials with inventory to authenticate it.</p> <p>This needs pretty tight ACLs and very good trust in security and administration of inventory and Kerberos, but done correctly solves the zero secret problem - no more need to manually insert secrets.</p> <p>On successful authentication the machine can request internally trusted self-signed certificates from the CA. If we already trust this process then asking for stored (Hashicorp Vault) or encrypted (SOPS, Ansible Vault) configuration secrets is a possibility as well. This opens a whole can of security worms, <em>but</em> a whole world of possibilites too!</p> <h2 id=how-do-i-access-vault>How do I access Vault?<a class=headerlink href=#how-do-i-access-vault title="Anchor link to this section for reference">ඞ</a></h2> <p>Use the CLI tool, by <a href=https://www.vaultproject.io/docs/install>installing it</a> and setting your environment variable <code>VAULT_ADDR='https://vault.cern.ch:8200'</code></p> <p>OR</p> <p>Use the web UI by navigating to https://vault.cern.ch:8200 in your browser and log in using LDAP method by using your CERN account credentials.</p> <h2 id=admin-guide>ADMIN GUIDE<a class=headerlink href=#admin-guide title="Anchor link to this section for reference">ඞ</a></h2> <p>Following sections describes what the Vault back-end admin must do in order to enable LDAP and Kerberos integrations to work with CERN auth methods and also how to map LDAP groups to Vault policies.</p> <h3 id=necessary-first-step>Necessary first step<a class=headerlink href=#necessary-first-step title="Anchor link to this section for reference">ඞ</a></h3> <p>Current CERN Kerberos configuration includes the lines which are incompatible with Vault as parsing these lines leads Vault to believe that the Kerberos is using v4 instead of v5:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1>1</a></span>
<span class=normal><a href=#__codelineno-0-2>2</a></span>
<span class=normal><a href=#__codelineno-0-3>3</a></span>
<span class=normal><a href=#__codelineno-0-4>4</a></span>
<span class=normal><a href=#__codelineno-0-5>5</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a>v4_name_convert = {
<a id=__codelineno-0-2 name=__codelineno-0-2></a>  host = {
<a id=__codelineno-0-3 name=__codelineno-0-3></a>    rcmd = host
<a id=__codelineno-0-4 name=__codelineno-0-4></a>  }
<a id=__codelineno-0-5 name=__codelineno-0-5></a>}
</code></pre></div></td></tr></table></div> <p>Duplicate Kerberos configuration:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-1-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a>cp<span class=w> </span>/etc/krb5.conf<span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <p>Remove incompatible Kerberos v4 lines (the following command finds the line <code>v4_name_convert</code> and deletes it + 4 lines after it in a file):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-2-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a>sed<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=s2>,</span><span class=k>$(</span>expr<span class=w> </span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=w> </span>+<span class=w> </span><span class=m>4</span><span class=k>)</span><span class=s2>d&quot;</span><span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <h3 id=ldap-config-user-auth>LDAP config (user auth)<a class=headerlink href=#ldap-config-user-auth title="Anchor link to this section for reference">ඞ</a></h3> <p><a href=https://www.vaultproject.io/docs/auth/ldap>Official Vault LDAP documentation</a> and <a href=https://www.vaultproject.io/api-docs/auth/ldap>API documentation</a>.</p> <p>Enable the LDAP auth method:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-3-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a>vault<span class=w> </span>auth<span class=w> </span><span class=nb>enable</span><span class=w> </span>ldap
</code></pre></div></td></tr></table></div> <p>Configure the LDAP auth method (for user auth):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-4-1> 1</a></span>
<span class=normal><a href=#__codelineno-4-2> 2</a></span>
<span class=normal><a href=#__codelineno-4-3> 3</a></span>
<span class=normal><a href=#__codelineno-4-4> 4</a></span>
<span class=normal><a href=#__codelineno-4-5> 5</a></span>
<span class=normal><a href=#__codelineno-4-6> 6</a></span>
<span class=normal><a href=#__codelineno-4-7> 7</a></span>
<span class=normal><a href=#__codelineno-4-8> 8</a></span>
<span class=normal><a href=#__codelineno-4-9> 9</a></span>
<span class=normal><a href=#__codelineno-4-10>10</a></span>
<span class=normal><a href=#__codelineno-4-11>11</a></span>
<span class=normal><a href=#__codelineno-4-12>12</a></span>
<span class=normal><a href=#__codelineno-4-13>13</a></span>
<span class=normal><a href=#__codelineno-4-14>14</a></span>
<span class=normal><a href=#__codelineno-4-15>15</a></span>
<span class=normal><a href=#__codelineno-4-16>16</a></span>
<span class=normal><a href=#__codelineno-4-17>17</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a>vault<span class=w> </span>write<span class=w> </span>auth/ldap/config<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-2 name=__codelineno-4-2></a><span class=w>  </span><span class=nv>binddn</span><span class=o>=</span><span class=s2>&quot;CN=&lt;SERVICE_USER&gt;,OU=Users,OU=Organic Units,DC=cern,dc=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-3 name=__codelineno-4-3></a><span class=w>  </span><span class=nv>bindpass</span><span class=o>=</span><span class=s2>&quot;&lt;SERVICE_PASSWORD&gt;&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-4 name=__codelineno-4-4></a><span class=w>  </span><span class=nv>url</span><span class=o>=</span><span class=s2>&quot;ldap://cerndc.cern.ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-5 name=__codelineno-4-5></a><span class=w>  </span><span class=nv>userattr</span><span class=o>=</span>sAMAccountName<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-6 name=__codelineno-4-6></a><span class=w>  </span><span class=nv>userdn</span><span class=o>=</span><span class=s2>&quot;DC=cern,DC=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-7 name=__codelineno-4-7></a><span class=w>  </span><span class=nv>groupfilter</span><span class=o>=</span><span class=s2>&quot;(&amp;(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-8 name=__codelineno-4-8></a><span class=w>  </span><span class=nv>groupattr</span><span class=o>=</span>memberOf<span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-9 name=__codelineno-4-9></a><span class=w>  </span><span class=nv>groupdn</span><span class=o>=</span><span class=s2>&quot;OU=Workgroups,DC=cern,DC=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-10 name=__codelineno-4-10></a><span class=w>  </span><span class=nv>certificate</span><span class=o>=</span><span class=s2>&quot;@/etc/openldap/cacerts/CERN_Root_Certification_Authority_2.pem&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=w>  </span><span class=nv>insecure_tls</span><span class=o>=</span><span class=nb>false</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-12 name=__codelineno-4-12></a><span class=w>  </span><span class=nv>starttls</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=w>  </span><span class=nv>discoverdn</span><span class=o>=</span><span class=nb>false</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-14 name=__codelineno-4-14></a><span class=w>  </span><span class=nv>case_sensitive_names</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-15 name=__codelineno-4-15></a><span class=w>  </span><span class=nv>use_token_groups</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-16 name=__codelineno-4-16></a><span class=w>  </span><span class=nv>upndomain</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-4-17 name=__codelineno-4-17></a><span class=w>  </span><span class=nv>username_as_alias</span><span class=o>=</span><span class=nb>true</span>
</code></pre></div></td></tr></table></div> <p>Arguments in detail:</p> <ul> <li>binddn - Distinguished name of object to bind when performing user and group search. Example: <code>cn=vault,ou=Users,dc=example,dc=com</code>. Used together with <code>bindpass</code> argument.</li> <li>bindpass - Password to use along with <code>binddn</code> argument when performing user search.</li> <li>url - The LDAP server to connect to. Examples: <a href=ldap://xldap.cern.ch>ldaps://xldap.cern.ch</a>, <a href=ldap://cerndc.cern.ch>ldap://cerndc.cern.ch</a>, <a href=ldap://cerndc.cern.ch>ldap://tndc.cern.ch</a> (Check <a href=https://wikis.cern.ch/display/ACCADM/Advanced+user+debugging+with+ldap+and+egroup+api>HERE</a> for more details). This can also be a comma-delineated list of URLs, in which case the servers will be tried in-order if there are errors during the connection process.</li> <li>userattr - Attribute on user attribute object matching the username passed when authenticating. Examples: <code>sAMAccountName</code>, <code>cn</code>, <code>uid</code>.</li> <li>userdn - Base DN under which to perform user search. Example: <code>ou=Users,dc=example,dc=com</code>.</li> <li>groupfilter - Go template used when constructing the group membership query. The template can access the following context variables: [<code>UserDN</code>, <code>Username</code>]. The default is <code>(|(memberUid={{.Username}})(member={{.UserDN}})(uniqueMember={{.UserDN}}))</code>, which is compatible with several common directory schemas. To support nested group resolution for Active Directory, instead use the following query: <code>(&amp;(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))</code>. Both examples work with CERN LDAP schema.</li> <li>groupattr - LDAP attribute to follow on objects returned by <code>groupfilter</code> in order to enumerate user group membership. Examples: for groupfilter queries returning <em>group</em> objects, use: <code>cn</code>. For queries returning <em>user</em> objects, use: <code>memberOf</code>. The default is <code>cn</code>.</li> <li>groupdn - LDAP search base to use for group membership search. This can be the root containing either groups or users. Example: <code>ou=Groups,dc=example,dc=com</code></li> <li>certificate - CA certificate to use when verifying LDAP server certificate, must be x509 PEM encoded. CERN certs are under <code>/etc/openldap/cacerts</code></li> <li>insecure_tls - If true, skips LDAP server SSL certificate verification - insecure, use with caution!</li> <li>starttls - If true, issues a <code>StartTLS</code> command after establishing an unencrypted connection.</li> <li>discoverdn - If true, use anonymous bind to discover the bind DN of a user.</li> <li>case_sensitive_names - If set, user and group names assigned to policies within the backend will be case sensitive. Otherwise, names will be normalized to lower case. Case will still be preserved when sending the username to the LDAP server at login time; this is only for matching local user/group definitions.</li> <li>use_token_groups - If true, groups are resolved through Active Directory tokens. This speeds up nested group membership resolution in large directories significantly. Highly recommended to enable this with CERN LDAP.</li> <li>upndomain - userPrincipalDomain used to construct the UPN string for the authenticating user. The constructed UPN will appear as <code>[username]@UPNDomain</code>. Example: <code>[example.com](http://example.com)</code>, which will cause vault to bind as <code>[username@example.com](mailto:username@example.com)</code>. CERN uses auth by username not by email so this must not be set.</li> <li>username_as_alias - If set to true, forces the auth method to use the username passed by the user as the alias name. (This would be convenient, but seems to not work for host keytab logins)</li> </ul> <p>Map Vault policies to LDAP groups:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-5-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a>vault<span class=w> </span>write<span class=w> </span>auth/ldap/groups/&lt;LDAP<span class=w> </span>GROUP<span class=w> </span>NAME&gt;<span class=w> </span><span class=nv>policies</span><span class=o>=</span>&lt;VAULT<span class=w> </span>POLICY<span class=w> </span>NAME&gt;
</code></pre></div></td></tr></table></div> <h3 id=kerberos-config-host-auth>Kerberos config (host auth)<a class=headerlink href=#kerberos-config-host-auth title="Anchor link to this section for reference">ඞ</a></h3> <p><a href=https://www.vaultproject.io/docs/auth/kerberos>Official Vault Kerberos documentation</a> and <a href=https://www.vaultproject.io/api-docs/auth/kerberos>API documentation</a>.</p> <p>Enable Kerberos authentication in Vault:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-6-1>1</a></span>
<span class=normal><a href=#__codelineno-6-2>2</a></span>
<span class=normal><a href=#__codelineno-6-3>3</a></span>
<span class=normal><a href=#__codelineno-6-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a>vault<span class=w> </span>auth<span class=w> </span><span class=nb>enable</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-2 name=__codelineno-6-2></a><span class=w>  </span>-passthrough-request-headers<span class=o>=</span>Authorization<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-3 name=__codelineno-6-3></a><span class=w>  </span>-allowed-response-headers<span class=o>=</span>www-authenticate<span class=w> </span><span class=se>\</span>
<a id=__codelineno-6-4 name=__codelineno-6-4></a><span class=w>  </span>kerberos
</code></pre></div></td></tr></table></div> <p>Encode keytab for the Kerberos plugin (on the same machine Vault service is deployed on):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-7-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1></a>base64<span class=w> </span>/etc/krb5.keytab<span class=w> </span>&gt;<span class=w> </span>krb5.keytab.base64
</code></pre></div></td></tr></table></div> <p>Configure the Kerberos auth method with the encoded keytab and entry name that will be used to verify inbound login requests:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-8-1>1</a></span>
<span class=normal><a href=#__codelineno-8-2>2</a></span>
<span class=normal><a href=#__codelineno-8-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1></a>vault<span class=w> </span>write<span class=w> </span>auth/kerberos/config<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=w>  </span><span class=nv>keytab</span><span class=o>=</span>@krb5.keytab.base64<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-3 name=__codelineno-8-3></a><span class=w>  </span><span class=nv>service_account</span><span class=o>=</span><span class=s2>&quot;host/vault.cern.ch&quot;</span>
</code></pre></div></td></tr></table></div> <p>NOTE: <code>service_account</code> must match a valid principal in the keytab!</p> <p>Configure the Kerberos auth method to communicate with LDAP (for host secrets):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-9-1> 1</a></span>
<span class=normal><a href=#__codelineno-9-2> 2</a></span>
<span class=normal><a href=#__codelineno-9-3> 3</a></span>
<span class=normal><a href=#__codelineno-9-4> 4</a></span>
<span class=normal><a href=#__codelineno-9-5> 5</a></span>
<span class=normal><a href=#__codelineno-9-6> 6</a></span>
<span class=normal><a href=#__codelineno-9-7> 7</a></span>
<span class=normal><a href=#__codelineno-9-8> 8</a></span>
<span class=normal><a href=#__codelineno-9-9> 9</a></span>
<span class=normal><a href=#__codelineno-9-10>10</a></span>
<span class=normal><a href=#__codelineno-9-11>11</a></span>
<span class=normal><a href=#__codelineno-9-12>12</a></span>
<span class=normal><a href=#__codelineno-9-13>13</a></span>
<span class=normal><a href=#__codelineno-9-14>14</a></span>
<span class=normal><a href=#__codelineno-9-15>15</a></span>
<span class=normal><a href=#__codelineno-9-16>16</a></span>
<span class=normal><a href=#__codelineno-9-17>17</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a>vault<span class=w> </span>write<span class=w> </span>auth/kerberos/config/ldap<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-2 name=__codelineno-9-2></a><span class=w>  </span><span class=nv>binddn</span><span class=o>=</span><span class=s2>&quot;CN=&lt;SERVICE_USER&gt;,OU=Users,OU=Organic Units,DC=cern,dc=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-3 name=__codelineno-9-3></a><span class=w>  </span><span class=nv>bindpass</span><span class=o>=</span><span class=s2>&quot;&lt;SERVICE_PASSWORD&gt;&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-4 name=__codelineno-9-4></a><span class=w>  </span><span class=nv>url</span><span class=o>=</span><span class=s2>&quot;ldap://cerndc.cern.ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-5 name=__codelineno-9-5></a><span class=w>  </span><span class=nv>userattr</span><span class=o>=</span>sAMAccountName<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-6 name=__codelineno-9-6></a><span class=w>  </span><span class=nv>userdn</span><span class=o>=</span><span class=s2>&quot;DC=cern,DC=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-7 name=__codelineno-9-7></a><span class=w>  </span><span class=nv>groupfilter</span><span class=o>=</span><span class=s2>&quot;(&amp;(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-8 name=__codelineno-9-8></a><span class=w>  </span><span class=nv>groupattr</span><span class=o>=</span>memberOf<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-9 name=__codelineno-9-9></a><span class=w>  </span><span class=nv>groupdn</span><span class=o>=</span><span class=s2>&quot;OU=Workgroups,DC=cern,DC=ch&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-10 name=__codelineno-9-10></a><span class=w>  </span><span class=nv>certificate</span><span class=o>=</span><span class=s2>&quot;@/etc/openldap/cacerts/CERN_Root_Certification_Authority_2.pem&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-11 name=__codelineno-9-11></a><span class=w>  </span><span class=nv>insecure_tls</span><span class=o>=</span><span class=nb>false</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-12 name=__codelineno-9-12></a><span class=w>  </span><span class=nv>starttls</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-13 name=__codelineno-9-13></a><span class=w>  </span><span class=nv>discoverdn</span><span class=o>=</span><span class=nb>false</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-14 name=__codelineno-9-14></a><span class=w>  </span><span class=nv>case_sensitive_names</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-15 name=__codelineno-9-15></a><span class=w>  </span><span class=nv>use_token_groups</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-16 name=__codelineno-9-16></a><span class=w>  </span><span class=nv>upndomain</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-17 name=__codelineno-9-17></a><span class=w>  </span><span class=nv>username_as_alias</span><span class=o>=</span><span class=nb>true</span>
</code></pre></div></td></tr></table></div> <p>Arguments are described in detail in the LDAP configuration section and not duplicated here as they are identical.</p> <p>Map Vault policies to LDAP groups:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-10-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1></a>vault<span class=w> </span>write<span class=w> </span>auth/kerberos/groups/&lt;LDAP<span class=w> </span>GROUP<span class=w> </span>NAME&gt;<span class=w> </span><span class=nv>policies</span><span class=o>=</span>&lt;VAULT<span class=w> </span>POLICY<span class=w> </span>NAME&gt;
</code></pre></div></td></tr></table></div> <h3 id=creating-policies>Creating policies<a class=headerlink href=#creating-policies title="Anchor link to this section for reference">ඞ</a></h3> <p><a href=https://www.vaultproject.io/docs/concepts/policies>Official Vault Policies documentation</a></p> <p>Everything in Vault is path based, and policies are no exception. Policies provide a declarative way to grant or forbid access to certain paths and operations in Vault. This section discusses policy workflows and syntaxes.</p> <p>Policies are <strong>deny by default</strong>, so an empty policy grants no permission in the system.</p> <h4 id=syntax-and-usage>Syntax and usage<a class=headerlink href=#syntax-and-usage title="Anchor link to this section for reference">ඞ</a></h4> <p>Policies are written in <a href=https://github.com/hashicorp/hcl>HCL</a> or JSON and describe which paths in Vault a user or machine is allowed to access.</p> <p>Here is a very simple policy which grants read capabilities to the path <code>secret/foo</code>:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-11-1>1</a></span>
<span class=normal><a href=#__codelineno-11-2>2</a></span>
<span class=normal><a href=#__codelineno-11-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1></a>path &quot;secret/foo&quot; {
<a id=__codelineno-11-2 name=__codelineno-11-2></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-11-3 name=__codelineno-11-3></a>}
</code></pre></div></td></tr></table></div> <p>When this policy is assigned to a token, the token can read from <code>secret/foo</code>. However, the token cannot update or delete <code>secret/foo</code>, since the capabilities do not allow it. Because policies are deny by default, the token would have no other access in Vault.</p> <p>Here is a more detailed policy, and it is documented inline:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-12-1> 1</a></span>
<span class=normal><a href=#__codelineno-12-2> 2</a></span>
<span class=normal><a href=#__codelineno-12-3> 3</a></span>
<span class=normal><a href=#__codelineno-12-4> 4</a></span>
<span class=normal><a href=#__codelineno-12-5> 5</a></span>
<span class=normal><a href=#__codelineno-12-6> 6</a></span>
<span class=normal><a href=#__codelineno-12-7> 7</a></span>
<span class=normal><a href=#__codelineno-12-8> 8</a></span>
<span class=normal><a href=#__codelineno-12-9> 9</a></span>
<span class=normal><a href=#__codelineno-12-10>10</a></span>
<span class=normal><a href=#__codelineno-12-11>11</a></span>
<span class=normal><a href=#__codelineno-12-12>12</a></span>
<span class=normal><a href=#__codelineno-12-13>13</a></span>
<span class=normal><a href=#__codelineno-12-14>14</a></span>
<span class=normal><a href=#__codelineno-12-15>15</a></span>
<span class=normal><a href=#__codelineno-12-16>16</a></span>
<span class=normal><a href=#__codelineno-12-17>17</a></span>
<span class=normal><a href=#__codelineno-12-18>18</a></span>
<span class=normal><a href=#__codelineno-12-19>19</a></span>
<span class=normal><a href=#__codelineno-12-20>20</a></span>
<span class=normal><a href=#__codelineno-12-21>21</a></span>
<span class=normal><a href=#__codelineno-12-22>22</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1></a># This section grants all access on &quot;secret/*&quot;. Further restrictions can be
<a id=__codelineno-12-2 name=__codelineno-12-2></a># applied to this broad policy, as shown below.
<a id=__codelineno-12-3 name=__codelineno-12-3></a>path &quot;secret/*&quot; {
<a id=__codelineno-12-4 name=__codelineno-12-4></a>  capabilities = [&quot;create&quot;, &quot;read&quot;, &quot;update&quot;, &quot;delete&quot;, &quot;list&quot;]
<a id=__codelineno-12-5 name=__codelineno-12-5></a>}
<a id=__codelineno-12-6 name=__codelineno-12-6></a>
<a id=__codelineno-12-7 name=__codelineno-12-7></a># Even though we allowed secret/*, this line explicitly denies
<a id=__codelineno-12-8 name=__codelineno-12-8></a># secret/super-secret. This takes precedence.
<a id=__codelineno-12-9 name=__codelineno-12-9></a>path &quot;secret/super-secret&quot; {
<a id=__codelineno-12-10 name=__codelineno-12-10></a>  capabilities = [&quot;deny&quot;]
<a id=__codelineno-12-11 name=__codelineno-12-11></a>}
<a id=__codelineno-12-12 name=__codelineno-12-12></a>
<a id=__codelineno-12-13 name=__codelineno-12-13></a># Policies can also specify allowed, disallowed, and required parameters. Here
<a id=__codelineno-12-14 name=__codelineno-12-14></a># the key &quot;secret/restricted&quot; can only contain &quot;foo&quot; (any value) and &quot;bar&quot; (one
<a id=__codelineno-12-15 name=__codelineno-12-15></a># of &quot;zip&quot; or &quot;zap&quot;).
<a id=__codelineno-12-16 name=__codelineno-12-16></a>path &quot;secret/restricted&quot; {
<a id=__codelineno-12-17 name=__codelineno-12-17></a>  capabilities = [&quot;create&quot;]
<a id=__codelineno-12-18 name=__codelineno-12-18></a>  allowed_parameters = {
<a id=__codelineno-12-19 name=__codelineno-12-19></a>    &quot;foo&quot; = []
<a id=__codelineno-12-20 name=__codelineno-12-20></a>    &quot;bar&quot; = [&quot;zip&quot;, &quot;zap&quot;]
<a id=__codelineno-12-21 name=__codelineno-12-21></a>  }
<a id=__codelineno-12-22 name=__codelineno-12-22></a>}
</code></pre></div></td></tr></table></div> <p>Policies use path-based matching to test the set of capabilities against a request. A policy <code>path</code> may specify an exact path to match, or it could specify a glob pattern which instructs Vault to use a prefix match:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-13-1> 1</a></span>
<span class=normal><a href=#__codelineno-13-2> 2</a></span>
<span class=normal><a href=#__codelineno-13-3> 3</a></span>
<span class=normal><a href=#__codelineno-13-4> 4</a></span>
<span class=normal><a href=#__codelineno-13-5> 5</a></span>
<span class=normal><a href=#__codelineno-13-6> 6</a></span>
<span class=normal><a href=#__codelineno-13-7> 7</a></span>
<span class=normal><a href=#__codelineno-13-8> 8</a></span>
<span class=normal><a href=#__codelineno-13-9> 9</a></span>
<span class=normal><a href=#__codelineno-13-10>10</a></span>
<span class=normal><a href=#__codelineno-13-11>11</a></span>
<span class=normal><a href=#__codelineno-13-12>12</a></span>
<span class=normal><a href=#__codelineno-13-13>13</a></span>
<span class=normal><a href=#__codelineno-13-14>14</a></span>
<span class=normal><a href=#__codelineno-13-15>15</a></span>
<span class=normal><a href=#__codelineno-13-16>16</a></span>
<span class=normal><a href=#__codelineno-13-17>17</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1></a># Permit reading only &quot;secret/foo&quot;. An attached token cannot read &quot;secret/food&quot;
<a id=__codelineno-13-2 name=__codelineno-13-2></a># or &quot;secret/foo/bar&quot;.
<a id=__codelineno-13-3 name=__codelineno-13-3></a>path &quot;secret/foo&quot; {
<a id=__codelineno-13-4 name=__codelineno-13-4></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-13-5 name=__codelineno-13-5></a>}
<a id=__codelineno-13-6 name=__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7></a># Permit reading everything under &quot;secret/bar&quot;. An attached token could read
<a id=__codelineno-13-8 name=__codelineno-13-8></a># &quot;secret/bar/zip&quot;, &quot;secret/bar/zip/zap&quot;, but not &quot;secret/bars/zip&quot;.
<a id=__codelineno-13-9 name=__codelineno-13-9></a>path &quot;secret/bar/*&quot; {
<a id=__codelineno-13-10 name=__codelineno-13-10></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-13-11 name=__codelineno-13-11></a>}
<a id=__codelineno-13-12 name=__codelineno-13-12></a>
<a id=__codelineno-13-13 name=__codelineno-13-13></a># Permit reading everything prefixed with &quot;zip-&quot;. An attached token could read
<a id=__codelineno-13-14 name=__codelineno-13-14></a># &quot;secret/zip-zap&quot; or &quot;secret/zip-zap/zong&quot;, but not &quot;secret/zip/zap
<a id=__codelineno-13-15 name=__codelineno-13-15></a>path &quot;secret/zip-*&quot; {
<a id=__codelineno-13-16 name=__codelineno-13-16></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-13-17 name=__codelineno-13-17></a>}
</code></pre></div></td></tr></table></div> <p>In addition, a <code>+</code> can be used to denote any number of characters bounded within a single path segment:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-14-1>1</a></span>
<span class=normal><a href=#__codelineno-14-2>2</a></span>
<span class=normal><a href=#__codelineno-14-3>3</a></span>
<span class=normal><a href=#__codelineno-14-4>4</a></span>
<span class=normal><a href=#__codelineno-14-5>5</a></span>
<span class=normal><a href=#__codelineno-14-6>6</a></span>
<span class=normal><a href=#__codelineno-14-7>7</a></span>
<span class=normal><a href=#__codelineno-14-8>8</a></span>
<span class=normal><a href=#__codelineno-14-9>9</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1></a># Permit reading the &quot;teamb&quot; path under any top-level path under secret/
<a id=__codelineno-14-2 name=__codelineno-14-2></a>path &quot;secret/+/teamb&quot; {
<a id=__codelineno-14-3 name=__codelineno-14-3></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-14-4 name=__codelineno-14-4></a>}
<a id=__codelineno-14-5 name=__codelineno-14-5></a>
<a id=__codelineno-14-6 name=__codelineno-14-6></a># Permit reading secret/foo/bar/teamb, secret/bar/foo/teamb, etc.
<a id=__codelineno-14-7 name=__codelineno-14-7></a>path &quot;secret/+/+/teamb&quot; {
<a id=__codelineno-14-8 name=__codelineno-14-8></a>  capabilities = [&quot;read&quot;]
<a id=__codelineno-14-9 name=__codelineno-14-9></a>}
</code></pre></div></td></tr></table></div> <h4 id=path-capabilities-cheat-sheet>Path capabilities cheat sheet<a class=headerlink href=#path-capabilities-cheat-sheet title="Anchor link to this section for reference">ඞ</a></h4> <p><a href=https://www.vaultproject.io/docs/concepts/policies#create><code>create</code></a> (<code>POST/PUT</code>) - Allows creating data at the given path. Very few parts of Vault distinguish between <code>create</code> and <code>update</code>, so most operations require both <code>create</code> and <code>update</code> capabilities. Parts of Vault that provide such a distinction are noted in documentation.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#read><code>read</code></a> (<code>GET</code>) - Allows reading the data at the given path.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#update><code>update</code></a> (<code>POST/PUT</code>) - Allows changing the data at the given path. In most parts of Vault, this implicitly includes the ability to create the initial value at the path.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#delete><code>delete</code></a> (<code>DELETE</code>) - Allows deleting the data at the given path.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#list><code>list</code></a> (<code>LIST</code>) - Allows listing values at the given path. Note that the keys returned by a <code>list</code> operation are <em>not</em> filtered by policies. Do not encode sensitive information in key names. Not all backends support listing.</p> <p>In addition to the standard set, there are some capabilities that do not map to HTTP verbs.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#sudo><code>sudo</code></a> - Allows access to paths that are <em>root-protected</em>. Tokens are not permitted to interact with these paths unless they have the <code>sudo</code> capability (in addition to the other necessary capabilities for performing an operation against that path, such as <code>read</code> or <code>delete</code>).</p> <p>For example, modifying the audit log backends requires a token with <code>sudo</code> privileges.</p> <p><a href=https://www.vaultproject.io/docs/concepts/policies#deny><code>deny</code></a> - Disallows access. This always takes precedence regardless of any other defined capabilities, including <code>sudo</code>.</p> <h4 id=templating-policies>Templating policies<a class=headerlink href=#templating-policies title="Anchor link to this section for reference">ඞ</a></h4> <p><a href="https://www.vaultproject.io/docs/concepts/policies#templated-policies=">Policy templating</a> allows the automating mapping of paths to certain users for example. Admin has no way of knowing who exactly will log into Vault and it would be very time inefficient to create a path for each user's personal secrets manually, templating enables to automate this.</p> <table> <thead> <tr> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>identity.entity.id</code></td> <td>The entity's ID</td> </tr> <tr> <td><code>identity.entity.name</code></td> <td>The entity's name</td> </tr> <tr> <td><code>identity.entity.metadata.&lt;metadata key&gt;</code></td> <td>Metadata associated with the entity for the given key</td> </tr> <tr> <td><code>identity.entity.aliases.&lt;mount accessor&gt;.id</code></td> <td>Entity alias ID for the given mount</td> </tr> <tr> <td><code>identity.entity.aliases.&lt;mount accessor&gt;.name</code></td> <td>Entity alias name for the given mount</td> </tr> <tr> <td><code>identity.entity.aliases.&lt;mount accessor&gt;.metadata.&lt;metadata key&gt;</code></td> <td>Metadata associated with the alias for the given mount and metadata key</td> </tr> <tr> <td><code>identity.entity.aliases.&lt;mount accessor&gt;.custom_metadata.&lt;custom_metadata key&gt;</code></td> <td>Custom metadata associated with the alias for the given mount and custom metadata key</td> </tr> <tr> <td><code>identity.groups.ids.&lt;group id&gt;.name</code></td> <td>The group name for the given group ID</td> </tr> <tr> <td><code>identity.groups.names.&lt;group name&gt;.id</code></td> <td>The group ID for the given group name</td> </tr> <tr> <td><code>identity.groups.ids.&lt;group id&gt;.metadata.&lt;metadata key&gt;</code></td> <td>Metadata associated with the group for the given key</td> </tr> <tr> <td><code>identity.groups.names.&lt;group name&gt;.metadata.&lt;metadata key&gt;</code></td> <td>Metadata associated with the group for the given key</td> </tr> </tbody> </table> <p>Examples:</p> <p>If you wanted to create a shared section of KV that is associated with entities that are in a group:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-15-1>1</a></span>
<span class=normal><a href=#__codelineno-15-2>2</a></span>
<span class=normal><a href=#__codelineno-15-3>3</a></span>
<span class=normal><a href=#__codelineno-15-4>4</a></span>
<span class=normal><a href=#__codelineno-15-5>5</a></span>
<span class=normal><a href=#__codelineno-15-6>6</a></span>
<span class=normal><a href=#__codelineno-15-7>7</a></span>
<span class=normal><a href=#__codelineno-15-8>8</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1></a># In the example below, the group ID maps a group and the path
<a id=__codelineno-15-2 name=__codelineno-15-2></a>path &quot;secret/data/groups/{{identity.groups.ids.fb036ebc-2f62-4124-9503-42aa7A869741.name}}/*&quot; {
<a id=__codelineno-15-3 name=__codelineno-15-3></a>  capabilities = [&quot;create&quot;, &quot;update&quot;, &quot;read&quot;, &quot;delete&quot;]
<a id=__codelineno-15-4 name=__codelineno-15-4></a>}
<a id=__codelineno-15-5 name=__codelineno-15-5></a>
<a id=__codelineno-15-6 name=__codelineno-15-6></a>path &quot;secret/metadata/groups/{{identity.groups.ids.fb036ebc-2f62-4124-9503-42aa7A869741.name}}/*&quot; {
<a id=__codelineno-15-7 name=__codelineno-15-7></a>  capabilities = [&quot;list&quot;]
<a id=__codelineno-15-8 name=__codelineno-15-8></a>}
</code></pre></div></td></tr></table></div> <p>If you wanted to create personal secrets path for every use that logs in using LDAP:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-16-1>1</a></span>
<span class=normal><a href=#__codelineno-16-2>2</a></span>
<span class=normal><a href=#__codelineno-16-3>3</a></span>
<span class=normal><a href=#__codelineno-16-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1></a># Anyone who logs in using LDAP with accessor auth_ldap_35641cad can create, update, read, delete secrets under the path kv/personal/&lt;LDAP USERNAME&gt;
<a id=__codelineno-16-2 name=__codelineno-16-2></a>path &quot;kv/personal/{{identity.entity.aliases.auth_ldap_35641cad.name}}/*&quot; {  
<a id=__codelineno-16-3 name=__codelineno-16-3></a>  capabilities = [ &quot;create&quot;, &quot;list&quot;, &quot;update&quot;, &quot;read&quot;, &quot;delete&quot; ]
<a id=__codelineno-16-4 name=__codelineno-16-4></a>}
</code></pre></div></td></tr></table></div> <h2 id=client-guide>CLIENT GUIDE<a class=headerlink href=#client-guide title="Anchor link to this section for reference">ඞ</a></h2> <h3 id=necessary-first-step-client>Necessary first step (client)<a class=headerlink href=#necessary-first-step-client title="Anchor link to this section for reference">ඞ</a></h3> <p>Current CERN Kerberos configuration includes the lines which are incompatible with Vault as parsing these lines leads Vault to believe that the Kerberos is using v4 instead of v5:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-17-1>1</a></span>
<span class=normal><a href=#__codelineno-17-2>2</a></span>
<span class=normal><a href=#__codelineno-17-3>3</a></span>
<span class=normal><a href=#__codelineno-17-4>4</a></span>
<span class=normal><a href=#__codelineno-17-5>5</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1></a>v4_name_convert = {
<a id=__codelineno-17-2 name=__codelineno-17-2></a>  host = {
<a id=__codelineno-17-3 name=__codelineno-17-3></a>    rcmd = host
<a id=__codelineno-17-4 name=__codelineno-17-4></a>  }
<a id=__codelineno-17-5 name=__codelineno-17-5></a>}
</code></pre></div></td></tr></table></div> <p>Duplicate Kerberos configuration:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-18-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1></a>cp<span class=w> </span>/etc/krb5.conf<span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <p>Remove incompatible Kerberos v4 lines (the following command finds the line <code>v4_name_convert</code> and deletes it + 4 lines after it in a file):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-19-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1></a>sed<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=s2>,</span><span class=k>$(</span>expr<span class=w> </span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=w> </span>+<span class=w> </span><span class=m>4</span><span class=k>)</span><span class=s2>d&quot;</span><span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <h4 id=user-auth>User auth<a class=headerlink href=#user-auth title="Anchor link to this section for reference">ඞ</a></h4> <p>The easiest way for users to authenticate to Vault is using the LDAP method.</p> <p>Authenticate to Vault using Vault CLI:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-20-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1></a>vault<span class=w> </span>login<span class=w> </span>-method<span class=o>=</span>ldap<span class=w> </span><span class=nv>username</span><span class=o>=</span>&lt;YOUR<span class=w> </span>USERNAME&gt;
</code></pre></div></td></tr></table></div> <h3 id=host-auth>Host auth<a class=headerlink href=#host-auth title="Anchor link to this section for reference">ඞ</a></h3> <p>The easiest way of automating access to Vault for hosts, deployment of apps, services or other autonomous tasks is to leverage keytabs and use the Vault's Kerberos login method. Every CERN host has or can have a valid keytab by using the <code>cern-get-keytab</code> CLI tool. The following will leverage this keytab as a means of authenticating to Vault. Please note that you can also create a key for a service as per <a href="https://www.vaultproject.io/docs/auth/kerberos#configuration=">the official documentation</a>, but this will not provide any meaningful compartmentalization as any automated tasks will still have to be executed as root. The only way to compartmentalize Vault access and secrets is to add hosts to e-groups/LDAP groups and map Vault policies to those groups.</p> <p>Users can also use the Kerberos methods, but this will <a href="https://www.vaultproject.io/docs/auth/kerberos#configuration=">require extra steps</a> (like creating a keytab, as the cache can't be used) that may prove this method to be too inconvenient compared to using LDAP.</p> <p>NOTE: this auth method gets a non-renewable token from Vault! TTL is set by the Vault administrator or whoever manages host auth policies. By default this token will be valid for 768h. Non-renewable token means that the service cannot use the obtained Vault token to request a new Vault token, instead renewal must be done by doing the described process again.</p> <p>Authenticate to Vault using Vault CLI:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-21-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1></a>vault<span class=w> </span>login<span class=w> </span>-method<span class=o>=</span>ldap<span class=w> </span><span class=nv>username</span><span class=o>=</span>&lt;YOUR<span class=w> </span>USERNAME&gt;
</code></pre></div></td></tr></table></div> <p>Arguments in detail:</p> <ul> <li>username - a valid Kerberos principal in a valid keytab.</li> <li>service - a valid principal that Vault back-end should use for obtaining a service ticket for gaining a SPNEGO token. This principal must also exist in LDAP.</li> <li>realm - name of the Kerberos realm. This realm must match the UPNDomain configured on the LDAP connection. This check is case-sensitive.</li> <li>keytab_path - path to a valid Kerberos ketab. The principal supplied as a username mentioned before must exist in this keytab.</li> <li>krb5conf_path - path to a valid Kerberos configuration. Note that some v4 settings will cause Vault to interpret an otherwise valid v5 configuration as invalid.</li> <li>disable_fast_negotiation (boolean) - toggle Kerberos auth method's default of using FAST negotiation. FAST is a pre-authentication framework for Kerberos. It includes a mechanism for tunneling pre-authentication exchanges using armoured KDC messages. FAST provides increased resistance to passive password guessing attacks. Some common Kerberos implementations do not support FAST negotiation. CERN Kerberos does not support FAST.</li> </ul> <p>OR authenicate to Vault using REST API:</p> <p><code>/auth/kerberos/login</code> endpoint allows you to log in with a valid Kerberos SPNEGO token. This token is obtained by the client, marshalled, and converted to base 64 using standard encoding.</p> <p>TODO: figure out and document a way to obtain a Kerberos SPNEGO token without Vault CLI or other dependencies.</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-22-1>1</a></span>
<span class=normal><a href=#__codelineno-22-2>2</a></span>
<span class=normal><a href=#__codelineno-22-3>3</a></span>
<span class=normal><a href=#__codelineno-22-4>4</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1></a>curl<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-2 name=__codelineno-22-2></a><span class=w>  </span>--header<span class=w> </span><span class=s2>&quot;Authorization: Negotiate &lt;BASE64 SPNEGO TOKEN&gt;&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-3 name=__codelineno-22-3></a><span class=w>  </span>--request<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-4 name=__codelineno-22-4></a><span class=w>  </span>http://<span class=k>$(</span>VAULT_ADDR<span class=k>)</span>:8200/v1/auth/kerberos/login
</code></pre></div></td></tr></table></div> <h3 id=using-vault>Using Vault<a class=headerlink href=#using-vault title="Anchor link to this section for reference">ඞ</a></h3> <p>Everything in Vault is path based, you can imagine these paths as similar to a Linux file tree, there is a root and paths spring out from there. Policies (created by admins or moderators of Vault) provide a declarative way to grant or forbid access to certain paths and operations in Vault.</p> <p>For any of the following to work requires a Vault admin to enable the use of any of the following <a href=https://www.vaultproject.io/docs/secrets>secret engines</a>.</p> <h4 id=key-value-secrets>Key-Value Secrets<a class=headerlink href=#key-value-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p><a href=https://www.vaultproject.io/docs/secrets/kv>Official</a> Vault KV Secrets documentation.</p> <p>The <code>kv</code> secrets engine is a generic Key-Value store used to store arbitrary secrets within the configured physical storage for Vault. This backend can be run in one of two modes; either it can be configured to store a single value for a key or, versioning can be enabled and a configurable number of versions for each key will be stored.</p> <p>When running the <code>kv</code> secrets backend non-versioned, only the most recently written value for a key will be preserved. The benefits of non-versioned <code>kv</code> is a reduced storage size for each key since no additional metadata or history is stored. Additionally, requests going to a backend configured this way will be more performant because for any given request there will be fewer storage calls and no locking.</p> <p>Non-versioned aka <a href=https://www.vaultproject.io/docs/secrets/kv/kv-v1>KV V1</a> is easier to set up and requires almost no extra setup.</p> <h4 id=secret-sharing-using-keyvalue-v1>Secret sharing using key/value V1<a class=headerlink href=#secret-sharing-using-keyvalue-v1 title="Anchor link to this section for reference">ඞ</a></h4> <p>Keeping personal secrets, sharing secrets with colleagues can be done most easily by mapping policies to e-groups/LDAP groups and using <a href=https://www.vaultproject.io/docs/concepts/policies#templated-policies>policy templating</a>. The following chapters documents the usage of using the <a href=https://www.vaultproject.io/docs/secrets/kv/kv-v1>KV V1</a> usage and not the <a href=https://www.vaultproject.io/docs/secrets/kv/kv-v2>KV V2</a>.</p> <h5 id=short-of-it-cheat-sheet>Short of it - cheat sheet<a class=headerlink href=#short-of-it-cheat-sheet title="Anchor link to this section for reference">ඞ</a></h5> <p>List enabled secrets engines:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-23-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1></a>vault<span class=w> </span>secrets<span class=w> </span>list
</code></pre></div></td></tr></table></div> <p>To set key/value secrets:</p> <ul> <li>Using CLI: <code>vault kv put &lt;KV ENGINE NAME&gt;/&lt;PATH&gt; &lt;KEY&gt;=&lt;VALUE&gt;</code></li> <li>Using API:</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-24-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1></a>curl<span class=w> </span>--header<span class=w> </span><span class=s2>&quot;X-Vault-Token: </span><span class=nv>$VAULT_TOKEN</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\ </span>--request<span class=w> </span>POST<span class=w> </span><span class=se>\ </span>--data<span class=w> </span>@payload.json<span class=w> </span><span class=se>\ </span><span class=nv>$VAULT_ADDR</span>/v1/&lt;KV<span class=w> </span>ENGINE<span class=w> </span>NAME&gt;/&lt;SECRET<span class=w> </span>PATH&gt;
</code></pre></div></td></tr></table></div> <p>Where payload is: <code>{ "key": "AAaaBBccDDeeOTXzSMT1234BB_Z8JzG7JkSVxI" }</code></p> <p>To get key/value secrets:</p> <ul> <li>Using CLI:</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-25-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1></a>vault<span class=w> </span>kv<span class=w> </span>get<span class=w> </span>&lt;KV<span class=w> </span>ENGINE<span class=w> </span>NAME&gt;/&lt;PATH&gt;
</code></pre></div></td></tr></table></div> <ul> <li>Using API:</li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-26-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1></a>curl<span class=w> </span>--header<span class=w> </span><span class=s2>&quot;X-Vault-Token: </span><span class=nv>$VAULT_TOKEN</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\ </span><span class=nv>$VAULT_ADDR</span>/v1/&lt;KV<span class=w> </span>ENGINE<span class=w> </span>NAME&gt;/&lt;SECRET<span class=w> </span>PATH&gt;
</code></pre></div></td></tr></table></div> <p>If you wish to enter secrets without exposing the secret in my shell's history:</p> <ul> <li>Using CLI, use a dash "-": <code>vault kv put &lt;KV ENGINE NAME&gt;/&lt;PATH&gt; &lt;KEY&gt;=-</code></li> <li>Use dash</li> <li>Press enter</li> <li>Type the secret</li> <li>Press Ctrl+d to end the pipe and write the secret</li> <li>Using API, use a JSON file for the payload.</li> </ul> <h5 id=long-of-it-a-practical-demo>Long of it - a practical demo<a class=headerlink href=#long-of-it-a-practical-demo title="Anchor link to this section for reference">ඞ</a></h5> <p>The following policy is something that is set up by the Vault admins, this is not something the client will have to bother with, but is displayed here just to provide extra context. Following example allows anyone with this policy to:</p> <ul> <li>see all secret <em>paths</em> (NOT secret values!) and create new secrets (only if secret does not exist, overwriting is not possible) under the enabled key-value store called <code>kv</code> via CLI and web UI.</li> <li>create, update, read and delete secrets under the <code>kv/acc-adm</code> path.</li> <li>create, update, read and delete secrets under their own name path in <code>kv</code> personal secrets path aka <code>kv/personal/&lt;USERNAME&gt;</code></li> </ul> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Terraform</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-27-1> 1</a></span>
<span class=normal><a href=#__codelineno-27-2> 2</a></span>
<span class=normal><a href=#__codelineno-27-3> 3</a></span>
<span class=normal><a href=#__codelineno-27-4> 4</a></span>
<span class=normal><a href=#__codelineno-27-5> 5</a></span>
<span class=normal><a href=#__codelineno-27-6> 6</a></span>
<span class=normal><a href=#__codelineno-27-7> 7</a></span>
<span class=normal><a href=#__codelineno-27-8> 8</a></span>
<span class=normal><a href=#__codelineno-27-9> 9</a></span>
<span class=normal><a href=#__codelineno-27-10>10</a></span>
<span class=normal><a href=#__codelineno-27-11>11</a></span>
<span class=normal><a href=#__codelineno-27-12>12</a></span>
<span class=normal><a href=#__codelineno-27-13>13</a></span>
<span class=normal><a href=#__codelineno-27-14>14</a></span>
<span class=normal><a href=#__codelineno-27-15>15</a></span>
<span class=normal><a href=#__codelineno-27-16>16</a></span>
<span class=normal><a href=#__codelineno-27-17>17</a></span>
<span class=normal><a href=#__codelineno-27-18>18</a></span>
<span class=normal><a href=#__codelineno-27-19>19</a></span>
<span class=normal><a href=#__codelineno-27-20>20</a></span>
<span class=normal><a href=#__codelineno-27-21>21</a></span>
<span class=normal><a href=#__codelineno-27-22>22</a></span>
<span class=normal><a href=#__codelineno-27-23>23</a></span>
<span class=normal><a href=#__codelineno-27-24>24</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1></a><span class=c1># List all secret paths</span>
<a id=__codelineno-27-2 name=__codelineno-27-2></a><span class=c1># Send write-only secrets to others</span>
<a id=__codelineno-27-3 name=__codelineno-27-3></a><span class=err>path</span><span class=w> </span><span class=s2>&quot;kv/*&quot;</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-27-4 name=__codelineno-27-4></a><span class=w>  </span><span class=na>capabilities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;create&quot;, &quot;list&quot;</span><span class=w> </span><span class=p>]</span>
<a id=__codelineno-27-5 name=__codelineno-27-5></a><span class=p>}</span>
<a id=__codelineno-27-6 name=__codelineno-27-6></a>
<a id=__codelineno-27-7 name=__codelineno-27-7></a><span class=c1># Web UI usage</span>
<a id=__codelineno-27-8 name=__codelineno-27-8></a><span class=err>path</span><span class=w> </span><span class=s2>&quot;kv/metadata&quot;</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-27-9 name=__codelineno-27-9></a><span class=w>  </span><span class=na>capabilities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;list&quot;</span><span class=p>]</span>
<a id=__codelineno-27-10 name=__codelineno-27-10></a><span class=p>}</span>
<a id=__codelineno-27-11 name=__codelineno-27-11></a>
<a id=__codelineno-27-12 name=__codelineno-27-12></a><span class=c1>###################### General secrets</span>
<a id=__codelineno-27-13 name=__codelineno-27-13></a>
<a id=__codelineno-27-14 name=__codelineno-27-14></a><span class=c1># General acc-adm secrets</span>
<a id=__codelineno-27-15 name=__codelineno-27-15></a><span class=err>path</span><span class=w> </span><span class=s2>&quot;kv/acc-adm/*&quot;</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-27-16 name=__codelineno-27-16></a><span class=w>  </span><span class=na>capabilities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;create&quot;, &quot;list&quot;, &quot;update&quot;, &quot;read&quot;, &quot;delete&quot;</span><span class=w> </span><span class=p>]</span>
<a id=__codelineno-27-17 name=__codelineno-27-17></a><span class=p>}</span>
<a id=__codelineno-27-18 name=__codelineno-27-18></a>
<a id=__codelineno-27-19 name=__codelineno-27-19></a><span class=c1>###################### Personal secrets</span>
<a id=__codelineno-27-20 name=__codelineno-27-20></a>
<a id=__codelineno-27-21 name=__codelineno-27-21></a><span class=c1># Personal secrets</span>
<a id=__codelineno-27-22 name=__codelineno-27-22></a><span class=err>path</span><span class=w> </span><span class=s2>&quot;kv/personal/{{identity.entity.aliases.auth_ldap_35641cad.name}}/*&quot;</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-27-23 name=__codelineno-27-23></a><span class=w>  </span><span class=na>capabilities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=s2>&quot;create&quot;, &quot;list&quot;, &quot;update&quot;, &quot;read&quot;, &quot;delete&quot;</span><span class=w> </span><span class=p>]</span>
<a id=__codelineno-27-24 name=__codelineno-27-24></a><span class=p>}</span>
</code></pre></div></td></tr></table></div> <h6 id=scenario-1-one-way-secret-sharing-with-another-user>Scenario 1 - one way secret sharing with another user<a class=headerlink href=#scenario-1-one-way-secret-sharing-with-another-user title="Anchor link to this section for reference">ඞ</a></h6> <p>Say that you wanted to share a secret to user called <code>kturvas</code>. You would use the following CLI command:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-28-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1></a>vault<span class=w> </span>kv<span class=w> </span>put<span class=w> </span>kv/personal/kturvas/inbox<span class=w> </span><span class=nv>secret_i_want_to_share</span><span class=o>=</span>hunter2
</code></pre></div></td></tr></table></div> <p>This command will succeed if <code>secret_i_want_to_share</code> does not yet exist, if it exists, you would have to choose another name for the secret, because you do not have the right to update existing secret values.</p> <p>But you would also notice that you can not read that value you shared with that user (you could test that by trying with <code>vault kv get kv/personal/kturvas</code>), because you only have write access.</p> <p>You would only be able to read, create, update, and delete secrets under your own user path <code>kv/personal/&lt;YOUR USERNAME&gt;</code></p> <p>So in essence this policy allows anyone to create write-only secrets which makes sharing secrets easy and secure.</p> <h6 id=scenario-2-general-secret-sharing>Scenario 2 - general secret sharing<a class=headerlink href=#scenario-2-general-secret-sharing title="Anchor link to this section for reference">ඞ</a></h6> <p>Say that you wanted to share a new password for a generic service user <code>accsvc</code> that is used by everyone in your group. Let's say that the group is <code>acc-adm-support</code> e-group.</p> <p>Assuming admin linked the policy to the <code>acc-adm-support</code> e-group then I would have access to create, update, read and delete secrets under the <code>kv/acc-adm</code> path upon login to Vault.</p> <p>So you would use the following CLI command:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-29-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1></a>vault<span class=w> </span>kv<span class=w> </span>put<span class=w> </span>kv/acc-adm/services/accsvc<span class=w> </span><span class=nv>password</span><span class=o>=</span>N3wSecur3p4ssw0rD!
</code></pre></div></td></tr></table></div> <h4 id=transit-secrets>Transit secrets<a class=headerlink href=#transit-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>The <a href="https://www.vaultproject.io/docs/secrets/transit#transit-secrets-engine=">transit secrets engine</a> handles cryptographic functions on data in-transit. Vault doesn't store the data sent to the secrets engine. It can also be viewed as "cryptography as a service" or "encryption as a service". The transit secrets engine can also sign and verify data; generate hashes and HMACs of data; and act as a source of random bytes.</p> <p>The primary use case for <code>transit</code> is to encrypt data from applications while still storing that encrypted data in some primary data store. This relieves the burden of proper encryption/decryption from application developers and pushes the burden onto the operators of Vault.</p> <p>After the secrets engine is configured and a user/machine has a Vault token with the proper permission, it can use this secrets engine.</p> <h5 id=usage-example>Usage example<a class=headerlink href=#usage-example title="Anchor link to this section for reference">ඞ</a></h5> <p>Encrypt some plaintext data using the <code>/encrypt</code> endpoint with a named key:</p> <p>NOTE<strong>:</strong> All plaintext data <strong>must be base64-encoded</strong>. The reason for this requirement is that Vault does not require that the plaintext is "text". It could be a binary file such as a PDF or image. The easiest safe transport mechanism for this data as part of a JSON payload is to base64-encode it.</p> <p>NOTE2: Vault HTTP API imposes a maximum request size of 32MB to prevent a denial of service attack. This can be tuned per <a href=https://www.vaultproject.io/docs/configuration/listener/tcp><code>listener</code> block</a> in the Vault server configuration.</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-30-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1></a>vault<span class=w> </span>write<span class=w> </span>transit/encrypt/my-key<span class=w> </span><span class=nv>plaintext</span><span class=o>=</span><span class=k>$(</span>base64<span class=w> </span><span class=o>&lt;&lt;&lt;</span><span class=w> </span><span class=s2>&quot;my secret data&quot;</span><span class=k>)</span>
</code></pre></div></td></tr></table></div> <p>You are the retured a key/value combination with the ciphertext.</p> <p>Decrypt a piece of data using the <code>/decrypt</code> endpoint with a named key:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-31-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1></a>vault<span class=w> </span>write<span class=w> </span>transit/decrypt/my-key<span class=w> </span><span class=nv>ciphertext</span><span class=o>=</span>vault:v1:8SDd3WHDOjf7mq69CyCqYjBXAiQQAVZRkFM13ok481zoCmHnSeDX9vyf7w<span class=o>==</span>
</code></pre></div></td></tr></table></div> <p>The resulting data is base64-encoded (see the note above for details on why). Decode it to get the raw plaintext:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-32-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1></a>base64<span class=w> </span>--decode<span class=w> </span><span class=o>&lt;&lt;&lt;</span><span class=w> </span><span class=s2>&quot;bXkgc2VjcmV0IGRhdGEK&quot;</span>
</code></pre></div></td></tr></table></div> <h4 id=transform-secrets-requires-vault-enterprise>Transform secrets (requires <a href=https://www.hashicorp.com/products/vault/ >Vault Enterprise</a>)<a class=headerlink href=#transform-secrets-requires-vault-enterprise title="Anchor link to this section for reference">ඞ</a></h4> <p>The <a href="https://www.vaultproject.io/docs/secrets/transform#transform-secrets-engine=">transform secrets engine</a> handles secure data transformation and tokenization against provided input value. The secret engine currently supports <code>fpe</code>, <code>masking</code>, and <code>tokenization</code> as data transformation types. The secret engine currently supports <code>fpe</code>, <code>masking</code>, and <code>tokenization</code> as data transformation types.</p> <h5 id=usage-example-transform>Usage example (transform)<a class=headerlink href=#usage-example-transform title="Anchor link to this section for reference">ඞ</a></h5> <p>After the secrets engine is configured and a user/machine has a Vault token with the proper permission, it can use this secrets engine to encode and decode input values.</p> <p>Encode some input value using the <code>/encode</code> endpoint with a named role:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-33-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1></a>vault<span class=w> </span>write<span class=w> </span>transform/encode/payments<span class=w> </span><span class=nv>value</span><span class=o>=</span><span class=m>1111</span>-2222-3333-4444
</code></pre></div></td></tr></table></div> <p>Which returns:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-34-1>1</a></span>
<span class=normal><a href=#__codelineno-34-2>2</a></span>
<span class=normal><a href=#__codelineno-34-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1></a>Key              Value
<a id=__codelineno-34-2 name=__codelineno-34-2></a>---              -----
<a id=__codelineno-34-3 name=__codelineno-34-3></a>encoded_value    9300-3376-4943-8903
</code></pre></div></td></tr></table></div> <p>Decode some input value using the <code>/decode</code> endpoint with a named role:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-35-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1></a>vault<span class=w> </span>write<span class=w> </span>transform/decode/payments<span class=w> </span><span class=nv>value</span><span class=o>=</span><span class=m>9300</span>-3376-4943-8903
</code></pre></div></td></tr></table></div> <p>Which returns:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-36-1>1</a></span>
<span class=normal><a href=#__codelineno-36-2>2</a></span>
<span class=normal><a href=#__codelineno-36-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1></a>Key              Value
<a id=__codelineno-36-2 name=__codelineno-36-2></a>---              -----
<a id=__codelineno-36-3 name=__codelineno-36-3></a>decoded_value    1111-2222-3333-4444
</code></pre></div></td></tr></table></div> <p>Decode some input value using the <code>/decode</code> endpoint with a named role and decode format:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-37-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1></a>vault<span class=w> </span>write<span class=w> </span>transform/decode/payments/last-four<span class=w> </span><span class=nv>value</span><span class=o>=</span><span class=m>9300</span>-3376-4943-8903
</code></pre></div></td></tr></table></div> <p>Which returns:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-38-1>1</a></span>
<span class=normal><a href=#__codelineno-38-2>2</a></span>
<span class=normal><a href=#__codelineno-38-3>3</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1></a>Key              Value
<a id=__codelineno-38-2 name=__codelineno-38-2></a>---              -----
<a id=__codelineno-38-3 name=__codelineno-38-3></a>decoded_value    4444
</code></pre></div></td></tr></table></div> <h4 id=active-directory-secrets>Active Directory secrets<a class=headerlink href=#active-directory-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>The <a href="https://www.vaultproject.io/docs/secrets/ad#active-directory-secrets-engine=">Active Directory (AD) secrets engine</a> has two main features:</p> <p>The first feature (password rotation) is where the AD secrets engine rotates AD passwords dynamically. This is designed for a high-load environment where many instances may be accessing a shared password simultaneously. With a simple set up and a simple creds API, it doesn't require instances to be manually registered in advance to gain access. Passwords are lazily rotated based on preset TTLs and can have a length configured to meet your needs. Additionally, passwords can be manually rotated using the <a href=https://www.vaultproject.io/api-docs/secret/ad#rotate-role-credentials>rotate-role</a> endpoint.</p> <p>The second feature (service account check-out) is where a library of service accounts can be checked out by a person or by machines. Vault will automatically rotate the password each time a service account is checked in. Service accounts can be voluntarily checked in, or Vault will check them in when their lending period (or, "ttl", in Vault's language) ends.</p> <h4 id=openldap-secrets>OpenLDAP secrets<a class=headerlink href=#openldap-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>The <a href="https://www.vaultproject.io/docs/secrets/openldap#openldap-secrets-engine=">OpenLDAP secret engine</a> allows management of LDAP entry passwords as well as dynamic creation of credentials. This engine supports interacting with Active Directory which is compatible with <strong>LDAP v3</strong>.</p> <h4 id=pki-secrets>PKI secrets<a class=headerlink href=#pki-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>The <a href="https://www.vaultproject.io/docs/secrets/pki#pki-secrets-engine=">PKI secrets engine</a> generates dynamic X.509 certificates. With this secrets engine, services can get certificates without going through the usual manual process of generating a private key and CSR, submitting to a CA, and waiting for a verification and signing process to complete. Vault's built-in authentication and authorization mechanisms provide the verification functionality.</p> <p>By keeping TTLs relatively short, revocations are less likely to be needed, keeping CRLs short and helping the secrets engine scale to large workloads. This in turn allows each instance of a running application to have a unique certificate, eliminating sharing and the accompanying pain of revocation and rollover.</p> <p>In addition, by allowing revocation to mostly be forgone, this secrets engine allows for ephemeral certificates. Certificates can be fetched and stored in memory upon application startup and discarded upon shutdown, without ever being written to disk.</p> <h5 id=usage-example-pki>Usage example (pki)<a class=headerlink href=#usage-example-pki title="Anchor link to this section for reference">ඞ</a></h5> <p>Configure a CA certificate and private key. Vault can accept an existing key pair, or it can generate its own self-signed root. In general, we recommend maintaining your root CA outside of Vault and providing Vault a signed intermediate CA:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-39-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1></a>vault<span class=w> </span>write<span class=w> </span>pki/root/generate/internal<span class=w> </span><span class=nv>common_name</span><span class=o>=</span>my-website.com<span class=w> </span><span class=nv>ttl</span><span class=o>=</span>8760h
</code></pre></div></td></tr></table></div> <p>Which returns:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-40-1>1</a></span>
<span class=normal><a href=#__codelineno-40-2>2</a></span>
<span class=normal><a href=#__codelineno-40-3>3</a></span>
<span class=normal><a href=#__codelineno-40-4>4</a></span>
<span class=normal><a href=#__codelineno-40-5>5</a></span>
<span class=normal><a href=#__codelineno-40-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1></a>Key              Value
<a id=__codelineno-40-2 name=__codelineno-40-2></a>---              -----
<a id=__codelineno-40-3 name=__codelineno-40-3></a>certificate      -----BEGIN CERTIFICATE-----...
<a id=__codelineno-40-4 name=__codelineno-40-4></a>expiration       1536807433
<a id=__codelineno-40-5 name=__codelineno-40-5></a>issuing_ca       -----BEGIN CERTIFICATE-----...
<a id=__codelineno-40-6 name=__codelineno-40-6></a>serial_number    7c:f1:fb:2c:6e:4d:99:0e:82:1b:08:0a:81:ed:61:3e:1d:fa:f5:29
</code></pre></div></td></tr></table></div> <p>Update the CRL location and issuing certificates:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-41-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1></a>vault<span class=w> </span>write<span class=w> </span>pki/config/urls<span class=w> </span><span class=nv>issuing_certificates</span><span class=o>=</span><span class=s2>&quot;http://127.0.0.1:8200/v1/pki/ca&quot;</span><span class=w> </span><span class=nv>crl_distribution_points</span><span class=o>=</span><span class=s2>&quot;http://127.0.0.1:8200/v1/pki/crl&quot;</span>
</code></pre></div></td></tr></table></div> <p>Configure a role that maps a name in Vault to a procedure for generating a certificate. When users or machines generate credentials, they are generated against this role:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-42-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1></a>vault<span class=w> </span>write<span class=w> </span>pki/roles/example-dot-com<span class=w> </span><span class=nv>allowed_domains</span><span class=o>=</span>my-website.com<span class=w> </span><span class=nv>allow_subdomains</span><span class=o>=</span><span class=nb>true</span><span class=w> </span><span class=nv>max_ttl</span><span class=o>=</span>72h
</code></pre></div></td></tr></table></div> <p>Generate a new credential by writing to the <code>/issue</code> endpoint with the name of the role:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-43-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1></a>vault<span class=w> </span>write<span class=w> </span>pki/issue/example-dot-com<span class=w> </span><span class=nv>common_name</span><span class=o>=</span>www.my-website.com
</code></pre></div></td></tr></table></div> <p>Which returns:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-44-1>1</a></span>
<span class=normal><a href=#__codelineno-44-2>2</a></span>
<span class=normal><a href=#__codelineno-44-3>3</a></span>
<span class=normal><a href=#__codelineno-44-4>4</a></span>
<span class=normal><a href=#__codelineno-44-5>5</a></span>
<span class=normal><a href=#__codelineno-44-6>6</a></span>
<span class=normal><a href=#__codelineno-44-7>7</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1></a>Key                 Value
<a id=__codelineno-44-2 name=__codelineno-44-2></a>---                 -----
<a id=__codelineno-44-3 name=__codelineno-44-3></a>certificate         -----BEGIN CERTIFICATE-----...
<a id=__codelineno-44-4 name=__codelineno-44-4></a>issuing_ca          -----BEGIN CERTIFICATE-----...
<a id=__codelineno-44-5 name=__codelineno-44-5></a>private_key         -----BEGIN RSA PRIVATE KEY-----...
<a id=__codelineno-44-6 name=__codelineno-44-6></a>private_key_type    rsa
<a id=__codelineno-44-7 name=__codelineno-44-7></a>serial_number       1d:2e:c6:06:45:18:60:0e:23:d6:c5:17:43:c0:fe:46:ed:d1:50:be
</code></pre></div></td></tr></table></div> <h4 id=database-secrets>Database secrets<a class=headerlink href=#database-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>The database secrets engine generates database credentials dynamically based on configured roles. It works with a number of different databases through a plugin interface. There are a number of built-in database types, and an exposed framework for running custom database types for extendability. This means that services that need to access a database no longer need to hardcode credentials: they can request them from Vault, and use Vault's leasing mechanism to more easily roll keys. These are referred to as "dynamic roles" or "dynamic secrets".</p> <p>Since every service is accessing the database with unique credentials, it makes auditing much easier when questionable data access is discovered. You can track it down to the specific instance of a service based on the SQL username.</p> <p>Vault makes use of its own internal revocation system to ensure that users become invalid within a reasonable time of the lease expiring.</p> <p>Supported databases:</p> <ul> <li><a href=https://www.vaultproject.io/docs/secrets/databases/cassandra>Cassandra</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/couchbase>Couchbase</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/elasticdb>Elasticsearch</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/hanadb>HanaDB</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/db2>IBM Db2</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/influxdb>InfluxDB</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/mongodb>MongoDB</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/mongodbatlas>MongoDB Atlas</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/mssql>MSSQL</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/mysql-maria>MySQL/MariaDB</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/oracle>Oracle</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/postgresql>PostgreSQL</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/redshift>Redshift</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/snowflake>Snowflake</a></li> <li><a href=https://www.vaultproject.io/docs/secrets/databases/custom>Custom</a></li> </ul> <h2 id=usage-quick-guide>USAGE QUICK GUIDE<a class=headerlink href=#usage-quick-guide title="Anchor link to this section for reference">ඞ</a></h2> <h3 id=cli>CLI<a class=headerlink href=#cli title="Anchor link to this section for reference">ඞ</a></h3> <p>Install Vault according to the <a href=https://www.vaultproject.io/docs/install>official documentation</a>. For CentOS:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-45-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1></a>sudo<span class=w> </span>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>yum-utils
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-46-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1></a>sudo<span class=w> </span>yum-config-manager<span class=w> </span>--add-repo<span class=w> </span>https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-47-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1></a>sudo<span class=w> </span>yum<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>vault
</code></pre></div></td></tr></table></div> <h4 id=cern-ad-user-usage>CERN AD user usage<a class=headerlink href=#cern-ad-user-usage title="Anchor link to this section for reference">ඞ</a></h4> <p>NOTE: following requires that you are part of the <code>acc-adm-support</code> e-group!</p> <p>Set Vault address:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-48-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1></a><span class=nb>export</span><span class=w> </span><span class=nv>VAULT_ADDR</span><span class=o>=</span><span class=s1>&#39;https://vault.cern.ch:8200&#39;</span>
</code></pre></div></td></tr></table></div> <p>Authenticate using LDAP method:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-49-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1></a>vault<span class=w> </span>login<span class=w> </span>-method<span class=o>=</span>ldap<span class=w> </span><span class=nv>username</span><span class=o>=</span><span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span>
</code></pre></div></td></tr></table></div> <p>List enabled secrets engines:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-50-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1></a>vault<span class=w> </span>secrets<span class=w> </span>list
</code></pre></div></td></tr></table></div> <h4 id=personal-secrets>Personal secrets<a class=headerlink href=#personal-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>Personal secrets path is a path that only one account has access to, the path where you create secrets that are specific to your use cases.</p> <p>Set key/value secrets under your personal user secrets path:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-51-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1></a>vault<span class=w> </span>kv<span class=w> </span>put<span class=w> </span>kv/personal/<span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span>/demosecret<span class=w> </span><span class=nv>my_first_secret</span><span class=o>=</span>sUp3rSuD0
</code></pre></div></td></tr></table></div> <p>Note that you are able to create secrets UNDER (<code>kv/personal/"$USER"/*</code>) your users path, but no ON (<code>kv/personal/"$USER"</code>) it.</p> <p>Get the secret you just put into Vault:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-52-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1></a>vault<span class=w> </span>kv<span class=w> </span>get<span class=w> </span>kv/personal/<span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span>/demosecret
</code></pre></div></td></tr></table></div> <p>List all secret paths under your user name:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-53-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1></a>vault<span class=w> </span>kv<span class=w> </span>list<span class=w> </span>kv/personal/<span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span>/
</code></pre></div></td></tr></table></div> <h4 id=inbox-secrets>Inbox secrets<a class=headerlink href=#inbox-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>Inbox secrets is a path template that allows sharing secrets with one account. Under every personal secret path there is a special sub path called inbox where other users have read/write access to (this is the only path in the personal secrets path where others have read/write access to). That path is <code>personal/&lt;USERNAME&gt;/inbox/from-&lt;ANY OTHER USERNAME&gt;/*</code></p> <p>Send someone else a secret:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-54-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1></a>vault<span class=w> </span>kv<span class=w> </span>put<span class=w> </span>kv/personal/kturvas/inbox/from-<span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span>/demosecret<span class=w> </span>secret_from_<span class=s2>&quot;</span><span class=nv>$USER</span><span class=s2>&quot;</span><span class=o>=</span>HelloVault!
</code></pre></div></td></tr></table></div> <p>Note that you only have access to other people's personal secrets path if it is under the inbox paths <code>kv/personal/*/inbox/from-"$USER"</code> and <code>kv/personal/*/inbox/"$USER"</code></p> <h4 id=general-secrets>General secrets<a class=headerlink href=#general-secrets title="Anchor link to this section for reference">ඞ</a></h4> <p>General secrets correspond to some policy that allows reading/writing secrets shared by a group of users (like users of an e-group/LDAP group). The following requires that you are part of the <code>acc-adm-support</code> e-group for example.</p> <p>Using what you've learned in the previous steps, try creating a secret under the path <code>kv/acc-adm</code> and then try fetching it or use the command</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-55-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1></a>vault<span class=w> </span>kv<span class=w> </span>list
</code></pre></div></td></tr></table></div> <h3 id=host>Host<a class=headerlink href=#host title="Anchor link to this section for reference">ඞ</a></h3> <p>Install Vault according to the <a href=https://www.vaultproject.io/docs/install>official documentation</a>. For CentOS:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-56-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1></a>sudo<span class=w> </span>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>yum-utils
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-57-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1></a>sudo<span class=w> </span>yum-config-manager<span class=w> </span>--add-repo<span class=w> </span><span class=o>[</span>https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo<span class=o>](</span>https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo<span class=o>)</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-58-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1></a>sudo<span class=w> </span>yum<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>vault
</code></pre></div></td></tr></table></div> <p>NOTE: this install method is temporary and should be done manually until we decide to have Vault in internal repos. You could also use the rpm on NFS at <code>/nfs/cs-ccr-nfshome/user/kturvas/starnet/vault-1.10.2-1.x86_64.rpm</code></p> <h4 id=cern-ad-host-usage>CERN AD host usage<a class=headerlink href=#cern-ad-host-usage title="Anchor link to this section for reference">ඞ</a></h4> <p>Your host must be part of Computers by OS Unknown group for the following to work since VMs used for testing were only in one group, Computers by OS Unknown, at the time of writing. Of course, the potential of dividing hosts in different e-groups in the future allows for more versatility.</p> <h4 id=manual-host-usage>Manual host usage<a class=headerlink href=#manual-host-usage title="Anchor link to this section for reference">ඞ</a></h4> <p>If you do not wish to add Vault to your host's ansible workflow or would just like to observe how it works in principal.</p> <p>Create the temporary second Kerberos configuration for Vault using <code>krb5.conf</code> as Vault identifies 4 lines of CERN krb5 conf as part of krb4 which it deems incompatible:</p> <p>Duplicate Kerberos configuration:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-59-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1></a>cp<span class=w> </span>/etc/krb5.conf<span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <p>Remove incompatible Kerberos v4 lines (the following command finds the line <code>v4_name_convert</code> and deletes it + 4 lines after it in a file):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-60-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1></a>sed<span class=w> </span>-i<span class=w> </span><span class=s2>&quot;</span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=s2>,</span><span class=k>$(</span>expr<span class=w> </span><span class=k>$(</span>grep<span class=w> </span>-n<span class=w> </span>v4_name_convert<span class=w> </span>/etc/krb5.conf.nov4<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span>:<span class=w> </span>-f1<span class=k>)</span><span class=w> </span>+<span class=w> </span><span class=m>4</span><span class=k>)</span><span class=s2>d&quot;</span><span class=w> </span>/etc/krb5.conf.nov4
</code></pre></div></td></tr></table></div> <p>Authenticate to Vault as <strong>root</strong> using the host keytab:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-61-1>1</a></span>
<span class=normal><a href=#__codelineno-61-2>2</a></span>
<span class=normal><a href=#__codelineno-61-3>3</a></span>
<span class=normal><a href=#__codelineno-61-4>4</a></span>
<span class=normal><a href=#__codelineno-61-5>5</a></span>
<span class=normal><a href=#__codelineno-61-6>6</a></span>
<span class=normal><a href=#__codelineno-61-7>7</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1></a>vault<span class=w> </span>login<span class=w> </span>-method<span class=o>=</span>kerberos<span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-2 name=__codelineno-61-2></a><span class=w>  </span><span class=nv>username</span><span class=o>=</span>host/<span class=s2>&quot;</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-3 name=__codelineno-61-3></a><span class=w>  </span><span class=nv>service</span><span class=o>=</span>host/vault.cern.ch<span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-4 name=__codelineno-61-4></a><span class=w>  </span><span class=nv>realm</span><span class=o>=</span>CERN.CH<span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-5 name=__codelineno-61-5></a><span class=w>  </span><span class=nv>keytab_path</span><span class=o>=</span>/etc/krb5.keytab<span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-6 name=__codelineno-61-6></a><span class=w>  </span><span class=nv>krb5conf_path</span><span class=o>=</span>/etc/krb5.conf.nov4<span class=w> </span><span class=se>\</span>
<a id=__codelineno-61-7 name=__codelineno-61-7></a><span class=w>  </span><span class=nv>disable_fast_negotiation</span><span class=o>=</span><span class=nb>true</span>
</code></pre></div></td></tr></table></div> <p>Now, if your host is also part of Computers by OS Unknown you will be able to <strong>read</strong> (not write or update) secrets under the path <code>kv/acc-adm/compos</code></p> <p>Authenticate as a user part of <code>acc-adm-support</code> to create secrets under that path for hosts to be able to read and fetch them.</p> <h4 id=ansible-host-usage>Ansible host usage<a class=headerlink href=#ansible-host-usage title="Anchor link to this section for reference">ඞ</a></h4> <p>It is advisable to organise tasks that use Vault in a manner where they are skipped if no connection to Vault is present. This allows using Vault in a very non-intrusive way where all previous workflows will not be affected in case of errors.</p> <p>Create the temporary second Kerberos configuration for Vault using <code>krb5.conf</code> as Vault identifies 4 lines of CERN krb5 conf as part of krb4 which it deems incompatible:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-62-1> 1</a></span>
<span class=normal><a href=#__codelineno-62-2> 2</a></span>
<span class=normal><a href=#__codelineno-62-3> 3</a></span>
<span class=normal><a href=#__codelineno-62-4> 4</a></span>
<span class=normal><a href=#__codelineno-62-5> 5</a></span>
<span class=normal><a href=#__codelineno-62-6> 6</a></span>
<span class=normal><a href=#__codelineno-62-7> 7</a></span>
<span class=normal><a href=#__codelineno-62-8> 8</a></span>
<span class=normal><a href=#__codelineno-62-9> 9</a></span>
<span class=normal><a href=#__codelineno-62-10>10</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1></a>- name: Check if Vault nov4 Kerberos conf exists
<a id=__codelineno-62-2 name=__codelineno-62-2></a>  stat:
<a id=__codelineno-62-3 name=__codelineno-62-3></a>    path: /etc/krb5.conf.nov4
<a id=__codelineno-62-4 name=__codelineno-62-4></a>  register: nov4
<a id=__codelineno-62-5 name=__codelineno-62-5></a>
<a id=__codelineno-62-6 name=__codelineno-62-6></a>- name: Create nov4 Kerberos conf
<a id=__codelineno-62-7 name=__codelineno-62-7></a>  shell: |
<a id=__codelineno-62-8 name=__codelineno-62-8></a>    cp /etc/krb5.conf /etc/krb5.conf.nov4
<a id=__codelineno-62-9 name=__codelineno-62-9></a>    sed -i &quot;$(grep -n v4_name_convert /etc/krb5.conf.nov4 | cut -d : -f1),$(expr $(grep -n v4_name_convert /etc/krb5.conf.nov4 | cut -d : -f1) + 4)d&quot; /etc/krb5.conf.nov4
<a id=__codelineno-62-10 name=__codelineno-62-10></a>  when: not nov4.stat.exists
</code></pre></div></td></tr></table></div> <p>For example create a task that checks Vault port and registers the result:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-63-1>1</a></span>
<span class=normal><a href=#__codelineno-63-2>2</a></span>
<span class=normal><a href=#__codelineno-63-3>3</a></span>
<span class=normal><a href=#__codelineno-63-4>4</a></span>
<span class=normal><a href=#__codelineno-63-5>5</a></span>
<span class=normal><a href=#__codelineno-63-6>6</a></span>
<span class=normal><a href=#__codelineno-63-7>7</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1></a>- name: Verify port 8200 is listening on vault.cern.ch
<a id=__codelineno-63-2 name=__codelineno-63-2></a>  wait_for:
<a id=__codelineno-63-3 name=__codelineno-63-3></a>    host: vault.cern.ch
<a id=__codelineno-63-4 name=__codelineno-63-4></a>    port: 8200
<a id=__codelineno-63-5 name=__codelineno-63-5></a>    timeout: 1
<a id=__codelineno-63-6 name=__codelineno-63-6></a>    register: vault_reachable
<a id=__codelineno-63-7 name=__codelineno-63-7></a>  ignore_errors: yes
</code></pre></div></td></tr></table></div> <p>Then add a check to all tasks that use Vault:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-64-1>1</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1></a>when: not vault_reachable.failed
</code></pre></div></td></tr></table></div> <p>Authenticating and getting a non-renewable token:</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-65-1> 1</a></span>
<span class=normal><a href=#__codelineno-65-2> 2</a></span>
<span class=normal><a href=#__codelineno-65-3> 3</a></span>
<span class=normal><a href=#__codelineno-65-4> 4</a></span>
<span class=normal><a href=#__codelineno-65-5> 5</a></span>
<span class=normal><a href=#__codelineno-65-6> 6</a></span>
<span class=normal><a href=#__codelineno-65-7> 7</a></span>
<span class=normal><a href=#__codelineno-65-8> 8</a></span>
<span class=normal><a href=#__codelineno-65-9> 9</a></span>
<span class=normal><a href=#__codelineno-65-10>10</a></span>
<span class=normal><a href=#__codelineno-65-11>11</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1></a>- name: Authenticate to Vault to get a fresh token
<a id=__codelineno-65-2 name=__codelineno-65-2></a>  shell: |
<a id=__codelineno-65-3 name=__codelineno-65-3></a>    export VAULT_ADDR=&#39;{{ vault_addr }}&#39;
<a id=__codelineno-65-4 name=__codelineno-65-4></a>    vault login -address=&quot;{{ vault_addr }}&quot; -method=kerberos \
<a id=__codelineno-65-5 name=__codelineno-65-5></a>    username=host/&quot;$(hostname)&quot; \
<a id=__codelineno-65-6 name=__codelineno-65-6></a>    service=host/vault.cern.ch \
<a id=__codelineno-65-7 name=__codelineno-65-7></a>    realm=CERN.CH \
<a id=__codelineno-65-8 name=__codelineno-65-8></a>    keytab_path=/etc/krb5.keytab \
<a id=__codelineno-65-9 name=__codelineno-65-9></a>    krb5conf_path=/etc/krb5.conf.nov4 \
<a id=__codelineno-65-10 name=__codelineno-65-10></a>    disable_fast_negotiation=true
<a id=__codelineno-65-11 name=__codelineno-65-11></a>  when: not vault_reachable.failed
</code></pre></div></td></tr></table></div> <p>Example of fetching and using secrets (inserting secrets into applications using <code>sed</code>):</p> <div class=highlight><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-66-1>1</a></span>
<span class=normal><a href=#__codelineno-66-2>2</a></span>
<span class=normal><a href=#__codelineno-66-3>3</a></span>
<span class=normal><a href=#__codelineno-66-4>4</a></span>
<span class=normal><a href=#__codelineno-66-5>5</a></span>
<span class=normal><a href=#__codelineno-66-6>6</a></span></pre></div></td><td class=code><div><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1></a>- name: Set the broker.json pass
<a id=__codelineno-66-2 name=__codelineno-66-2></a>  shell: |
<a id=__codelineno-66-3 name=__codelineno-66-3></a>    export BROKER_PASS=$(vault kv get -address=&#39;{{ vault_addr }}&#39; -field=&quot;{{ fastx_config.broker_pass_var }}&quot; kv/acc-adm/compos/rog)
<a id=__codelineno-66-4 name=__codelineno-66-4></a>    sed -i &quot;s/brokerPass/${BROKER_PASS}/&quot; /etc/fastx/broker.json
<a id=__codelineno-66-5 name=__codelineno-66-5></a>    sed -i &quot;s/^requirepass.*/requirepass ${BROKER_PASS}/g&quot; /etc/redis/redis.conf
<a id=__codelineno-66-6 name=__codelineno-66-6></a>  when: not vault_reachable.failed
</code></pre></div></td></tr></table></div> <h3 id=web-ui>Web UI<a class=headerlink href=#web-ui title="Anchor link to this section for reference">ඞ</a></h3> <h4 id=cern-ad-user-usage_1>CERN AD user usage<a class=headerlink href=#cern-ad-user-usage_1 title="Anchor link to this section for reference">ඞ</a></h4> <p>NOTE: following requires that you are part of the acc-adm-support e-group!</p> <p>Navigate to <a href=https://vault.cern.ch:8200>https://vault.cern.ch:8200</a> and login using LDAP method with your CERN credentials:</p> <p><a class=glightbox href=../attachments/187372014/187371990.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371990.png></a></p> <p>Click on <code>kv/</code> secrets engine:</p> <p><a class=glightbox href=../attachments/187372014/187371992.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371992.png></a></p> <h4 id=personal-secrets_1>Personal secrets<a class=headerlink href=#personal-secrets_1 title="Anchor link to this section for reference">ඞ</a></h4> <p>Personal secrets path is a path that only one account has access to, the path where you create secrets that are specific to your use cases.</p> <p>Click on the <code>personal/</code> path:</p> <p><a class=glightbox href=../attachments/187372014/187371993.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371993.png></a></p> <p>Click on "Create secret":</p> <p><a class=glightbox href=../attachments/187372014/187371995.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371995.png></a></p> <p>Set key/value secrets under your personal user secrets path:</p> <p><a class=glightbox href=../attachments/187372014/187371996.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371996.png></a></p> <p>Now you should be able to see the new secret you created:</p> <p><a class=glightbox href=../attachments/187372014/187371997.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187371997.png></a></p> <h4 id=inbox-secrets_1>Inbox secrets<a class=headerlink href=#inbox-secrets_1 title="Anchor link to this section for reference">ඞ</a></h4> <p>Inbox secrets is a path template that allows sharing secrets with one account. Under every personal secret path there is a special sub path called inbox where other users have read/write access to (this is the only path in the personal secrets path where others have read/write access to). That path is <code>personal/&lt;USERNAME&gt;/inbox/from-&lt;ANY OTHER USERNAME&gt;/*</code></p> <p>Create a new secret under someone elses inbox:</p> <p><a class=glightbox href=../attachments/187372014/187372186.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187372186.png></a></p> <p>Note that you only have access to other people's personal secrets path if it is under the inbox paths <code>kv/personal/*/from-"$USER"</code> and <code>kv/personal/*/"$USER"</code>:</p> <p><a class=glightbox href=../attachments/187372014/187372187.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt src=../attachments/187372014/187372187.png></a></p> <h4 id=general-secrets_1>General secrets<a class=headerlink href=#general-secrets_1 title="Anchor link to this section for reference">ඞ</a></h4> <p>General secrets correspond to some policy that allows reading/writing secrets shared by a group of users (like users of an e-group/LDAP group). The following requires that you are part of the <code>acc-adm-support</code> e-group for example.</p> <p>Using what you've learned in the previous steps, try creating a secret under the path <code>kv/acc-adm</code> and then try fetching it or use the web UI to see what secrets others have created under <code>kv/acc-adm</code>.</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://jamfox.dev/ target=_blank rel=noopener title=jamfox.dev class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"/></svg> </a> <a href=https://github.com/JamFox target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/katurv/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.instagram.com/karlturvas/ target=_blank rel=noopener title=www.instagram.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=https://brain.jamfox.dev/ target=_blank rel=noopener title=brain.jamfox.dev class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M184 0c30.9 0 56 25.1 56 56v400c0 30.9-25.1 56-56 56-28.9 0-52.7-21.9-55.7-50.1-5.2 1.4-10.7 2.1-16.3 2.1-35.3 0-64-28.7-64-64 0-7.4 1.3-14.6 3.6-21.2C21.4 367.4 0 338.2 0 304c0-31.9 18.7-59.5 45.8-72.3C37.1 220.8 32 207 32 192c0-30.7 21.6-56.3 50.4-62.6C80.8 123.9 80 118 80 112c0-29.9 20.6-55.1 48.3-62.1 3-28 26.8-49.9 55.7-49.9zm144 0c28.9 0 52.6 21.9 55.7 49.9C411.5 56.9 432 82 432 112c0 6-.8 11.9-2.4 17.4 28.8 6.2 50.4 31.9 50.4 62.6 0 15-5.1 28.8-13.8 39.7 27.1 12.8 45.8 40.4 45.8 72.3 0 34.2-21.4 63.4-51.6 74.8 2.3 6.6 3.6 13.8 3.6 21.2 0 35.3-28.7 64-64 64-5.6 0-11.1-.7-16.3-2.1-3 28.2-26.8 50.1-55.7 50.1-30.9 0-56-25.1-56-56V56c0-30.9 25.1-56 56-56z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["header.autohide", "navigation.tabs", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.tabs.sticky", "content.tabs.link", "search.share", "content.code.annotate", "content.code.copy", "content.action.view", "navigation.indexes", "navigation.prune"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.c8d2eff1.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../../../javascripts/tablesort.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>